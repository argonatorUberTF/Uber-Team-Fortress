void(float inp) Menu_Input;
void(float inp) Menu_Class_Input;
void () ConcussionGrenadeTimer;
void () HallucinationTimer;
void () TranquiliserTimer;
void (entity targ,entity inflictor,entity attacker,float damage,float T_flags,float T_AttackType) TF_T_Damage;
void () W_SetCurrentAmmo;
void (entity p) bound_other_ammo;
float (float tno) TeamFortress_TeamSet;
void (entity p) TeamFortress_SetSkin;
float (float tno) TeamFortress_TeamGetColor;
void () TeamFortress_ChangeClass;
void (float type) TeamFortress_DropAmmo;
void (entity p) TeamFortress_SetSpeed;
void (entity inflictor,entity attacker,float damage,entity ignore) T_RadiusDamage;
void (float inp) Menu_DropStuff_Input;
void (float inp) Menu_Taunt_Input;
float (float tno) TeamFortress_TeamIsCivilian;
void (float class) TeamFortress_SpyChangeSkin;
void (float teamno) TeamFortress_SpyChangeColor;
void (float objtobuild) TeamFortress_Build;
void (float _p_9330) TeamFortress_SpyFeignDeath;
void (entity spy) Spy_RemoveDisguise;
void () lvl1_sentry_stand;
void () lvl2_sentry_stand;
void () lvl3_sentry_stand;
void (float menu_no) DisplayMenu;
void () Menu_Team;
void () Menu_Class;
void () Menu_Drop;
void () Menu_Intro;
void () PlayerObserverMode;
void () Menu_ClassHelp;
void () Menu_ClassHelp2;
void () Menu_StuffClassHelp;
void (float inp) Menu_ClassHelp_Input;
void () Menu_DoBindings;
void () Menu_ShowBindings1;
void () Menu_ShowBindings2;
void () Menu_RepeatHelp;
void () Menu_Spy;
void () Menu_Spy_Skin;
void () Menu_Spy_Color;
void (float inp) Menu_Spy_Input;
void (float inp) Menu_Spy_Skin_Input;
void (float inp) Menu_Spy_Color_Input;
void () Menu_Engineer;
void () Menu_EngineerFix_Dispenser;
void () Menu_EngineerFix_SentryGun;
void (float inp) Menu_Engineer_Input;
void (float inp) Menu_EngineerFix_Dispenser_Input;
void (float inp) Menu_EngineerFix_SentryGun_Input;
void () Menu_EngineerFix_Tesla;
void (float inp) Menu_EngineerFix_Tesla_Input;
void () Menu_Dispenser;
void (float inp) Menu_Dispenser_Input;
void () Menu_DropStuff;
void () Menu_Taunt;
void () Menu_Yell;
void (float inp) Menu_Yell_Input;
void() Menu_EngineerFix_Teleporter;
void(float inp) Menu_EngineerFix_Teleporter_Input;
void() Menu_EngineerFix_Camera;
void(float inp) Menu_EngineerFix_Camera_Input;
void (entity gun, entity disp) Engineer_UseRemoteTesla;
void (entity field, float downtime) ForceField_Remove;
void () Menu_EngineerFix_FieldGen;
void (float inp) Menu_EngineerFix_FieldGen_Input;
void () DoTinker;
void () Menu_NewTaunts;
void (float inp) Menu_NewTaunts_Input;
void () Menu_Res;
void (float inp) Menu_Res_Input;
void () Menu_VoteChoice;
void (float inp) Menu_VoteChoice_Input;
void () Menu_Merchant;
void (float inp) Menu_Merchant_Input;
void () Menu_Blackjack;
void (float inp) Menu_Blackjack_Input;
#ifdef mtf_coop_quests
void () Menu_Quest;
void (float inp) Menu_Quest_Input;
#endif
float (float tmno) TeamFortress_TeamGetIllegalClasses;
void (float tno,entity ignore,string st) teamsprint;
void () Player_Menu =
{
	if ((self.menu_count > 25.000000))
	{
		self.menu_count = 0.000000;
	}
	else
	{
		self.menu_count = (self.menu_count + 1.000000);
		return;
	}
	if (self.current_menu == 3)
{
		if (TeamFortress_TeamIsCivilian(self.team_no))
			CSQC_SendMenu(self, self.current_menu, 666, 0);
		else
			CSQC_SendMenu(self, self.current_menu, illegalclasses, TeamFortress_TeamGetIllegalClasses(self.team_no));
	}
	else
	{
		CSQC_SendMenu(self, self.current_menu, 0, 0);
	}
	if ((self.current_menu == 5.000000))
	{
		Menu_Intro ();
		self.current_menu = 1.000000;
	}
	else
	{
		if ((self.current_menu == 6.000000))
		{
			Menu_ClassHelp ();
			if ((self.menu_displaytime > 8.000000))
			{
				self.current_menu = 1.000000;
			}
			else
			{
				self.menu_displaytime = (self.menu_displaytime + 1.000000);
			}
		}
		else
		{
			if ((self.current_menu == 7.000000))
			{
				Menu_ClassHelp2 ();
				if ((self.menu_displaytime > 5.000000))
				{
					self.current_menu = 1.000000;
				}
				else
				{
					self.menu_displaytime = (self.menu_displaytime + 1.000000);
				}
			}
			else
			{
				if (self.current_menu == 10)
				{
					Menu_ShowBindings1();
					if (self.menu_displaytime > 8)
					{
						self.current_menu = TF_FLARE_OFF;
					}
					else
					{
						self.menu_displaytime = self.menu_displaytime + TF_FLARE_OFF;
					}
				}
				else
				{
					if (self.current_menu == 11)
					{
						Menu_ShowBindings2();
						if (self.menu_displaytime > 8)
						{
							self.current_menu = TF_FLARE_OFF;
						}
						else
						{
							self.menu_displaytime = self.menu_displaytime + TF_FLARE_OFF;
						}
					}
					else
					{
						if (self.current_menu == 4)
						{
							Menu_Drop();
						}
						else
						{
							if (self.current_menu == 20)
							{
								Menu_DropStuff();
							}
							else
							{
								if (self.current_menu == 21)
								{
									Menu_Taunt();
								}
								else
								{
									if (self.current_menu == 22)
									{
										Menu_Yell();
									}
									else
									{
										if (self.current_menu == 12)
										{
											Menu_Spy();
										}
										else
										{
											if (self.current_menu == 13)
											{
												Menu_Spy_Skin();
											}
											else
											{
												if (self.current_menu == 14)
												{
													Menu_Spy_Color();
												}
												else
												{
													if (self.current_menu == 15)
													{
														Menu_Engineer();
													}
													else
													{
														if (self.current_menu == 16)
														{
															Menu_EngineerFix_Dispenser();
														}
														else
														{
															if (self.current_menu == 17)
															{
																Menu_EngineerFix_SentryGun();
															}
															else
															{
															if ((self.current_menu == 18))
															{
																Menu_EngineerFix_Tesla ();
															}
															else
															{
															if ((self.current_menu == 33))
															{
																Menu_EngineerFix_Teleporter();
															}
															else
															{
															if ((self.current_menu == 34))
															{
																Menu_EngineerFix_Camera();
															}
															else
															{
															if ((self.current_menu == 35))
															{
																Menu_EngineerFix_FieldGen();
															}
															else
															{
															if ((self.current_menu == 40))
															{
																Menu_NewTaunts();
															}
															else
															{

															if ( self.current_menu == 41 )
															{
																Menu_Res();
															}
															else
															{

															if ( self.current_menu == 43 )
															{
																Menu_Merchant();
															}
															else
															{
															if ( self.current_menu == 44 )
															{
																Menu_Blackjack();
															}
															else
															if ( self.current_menu == 42 )
															{
																Menu_VoteChoice();
															}
															else
															{
																if (self.current_menu == 19)
																{
																	Menu_Dispenser();
																}
																else
																{
																	if (self.current_menu == 8)
																	{
																		Menu_RepeatHelp();
																		self.current_menu = TF_FLARE_OFF;
																	}
																	else
																	{
																		if (self.current_menu == 9)
																		{
																			Menu_DoBindings();
																		}
																		else
																		{
																			if (self.current_menu == 23)
																			{
																				self.vote_menu = self.test_input;
																				//Menu_Vote();
																			}
																			else
																			{
																				if (self.team_no == TF_FLARE_LIT && teamplay && self.lives != TF_FLARE_LIT)
																				{
																					self.current_menu = 2;
																					Menu_Team();
																				}
																				else
																				{
																					if ( (self.playerclass == TF_FLARE_LIT && self.lives != TF_FLARE_LIT) || (self.current_menu == 3) )
																					{
																						self.current_menu = 3;
																						Menu_Class();
																					}
																					else
																					{
																						self.current_menu = TF_FLARE_LIT;
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	} } } } }
	}
	} } }
};
void(float menu_no) DisplayMenu = 
{
	self.current_menu = menu_no;
	if (menu_no == 2)
	{
		Menu_Team();
	}
	else
	{
		if (menu_no == 3)
		{
			Menu_Class();
		}
	}
};
void () Menu_Team =
{
	if (survival_mode)
	{
		if (MONSTER_TEAM_ENABLED)
		{
			CenterPrint4 (self, "\n\n“.. Survivors (Blue)1   \n”.. Monsters (Red) 2     \n .. Yellow Team 3\n ..Green Team 4\n How to play:\n\nIn survival mode, all players have one\nlife and must survive based on mutual\nteamwork and player resurrection.\n When a player is killed he must use the\n \"saveme\" command to get others to help\n him up before it's too late.\n");
		}
		else
		{
			CenterPrint4 (self, "\n\n\" Welcome to Survival Mode \n\n“Select team [1 to 4].\n\n Survivors Blue team 1\n\n Red Monsters team 2\n\n Yellow team 3\n\n Green Team 4\n\n\nHow to play:\nIn survival mode, all players have one\nlife and must survive based on mutual\nteamwork and player resurrection.\n When a player is killed he must use the\n \"saveme\" command to get others to help\n him/her up before it's too late.\n");
		return;
		}
	}
	else
	{
		TeamFortress_TeamSet(1);
		ResetMenu();
		self.impulse = TF_FLARE_LIT;
		stuffcmd(self, "exec ");
		stuffcmd(self, mapname);
		stuffcmd(self, ".cfg\n");
	}
};
void(float inp) Menu_Team_Input = 
{
	local float args, i;
	local entity ipl;
	if (survival_mode)
	{
		ipl = find(world,classname,"monster_score");
		if (ipl != world)
		{
			i = 0;
			args = tokenize(ipl.noise1);
			while (i<args)
			{
				if (argv(i) == infokey(self, "ip"))
				{
					sprint(self,2,"You have died and cannot reconnect until a player finds a resurrection cube\nor until a new map is started.\nNote: You can still vote even though you are not in the game.\n");
					ResetMenu();
					self.impulse = 0;
					return;
				}
				i++;
			}
		}
		else 
			bprint(2,"ERROR!!! monster_score not found! Tell DEV!\n");
		if (MONSTER_TEAM_ENABLED)
		{
			if (inp == 1 || inp > 2)
				TeamFortress_TeamSet(1);
			else
if (inp == 2)
				if (!Monsterteam_full())
				{
					self.monster_type = 10;
					TeamFortress_TeamSet(2);
				}
		}
		else
if (inp == 1)
		{
			TeamFortress_TeamSet(1);
		}
		if (inp == 2)
		{
			TeamFortress_TeamSet(2);
		}
		if (inp == 3)
		{
			TeamFortress_TeamSet(3);
		}
		if (inp == 4)
		{
		TeamFortress_TeamSet(4);
		}
	}
	else
	return;
	if (inp == 5)
	{
		TeamFortress_TeamPutPlayerInTeam();
	}
	else
	{
		if (inp <= number_of_teams && inp > TF_FLARE_LIT)
		{
			TeamFortress_TeamSet(inp);
		}
		else
		{
			if (number_of_teams == TF_FLARE_LIT && inp <= 4)
			{
				TeamFortress_TeamSet(inp);
			}
			else
			{
				if (inp == 7)
				{
					self.current_menu = 9;
				}
				else
				{
					if (inp == 8)
					{
						TeamFortress_TeamPutPlayerInTeam();
					}
				}
			}
		}
	}
	ResetMenu();
	self.impulse = TF_FLARE_LIT;
	stuffcmd(self, "exec ");
	stuffcmd(self, mapname);
	stuffcmd(self, ".cfg\n");
};
void() Menu_Class = 
{
	if (lms_entity == world)
{
		// kick idlers (send them to spec)
		if (!self.#kick_idle_time)
			self.#kick_idle_time = time + 160;

		if (self.#kick_idle_time < time && !self.playerclass)
{
			bprint( 2, self.netname );
			bprint( 2, " is idling - moving to spectator\n" );
			stuffcmd( self, "spectator 1\n" );
			stuffcmd( self, "setinfo spectator 1\n" );		// extra check incase someone renamed the spectator cmd
			stuffcmd( self, "reconnect\n" );
		}
	}
	local entity AD;
	AD = find(world, classname, "info_tfdetect");
	if (AD)
	{
		if (self.team_no == TF_FLARE_OFF)
		{
			if (AD.noise1 != string_null)
			{
				CenterPrint(self, AD.noise1);
				return;
			}
		}
		else
		{
			if (self.team_no == 2)
			{
				if (AD.noise2 != string_null)
				{
					CenterPrint(self, AD.noise2);
					return;
				}
			}
			else
			{
				if (self.team_no == 3)
				{
					if (AD.noise3 != string_null)
					{
						CenterPrint(self, AD.noise3);
						return;
					}
				}
				else
				{
					if (self.team_no == 4)
					{
						if (AD.noise4 != string_null)
						{
							CenterPrint(self, AD.noise4);
							return;
						}
					}
				}
			}
		}
	}
	else
if (MONSTER_TEAM_ENABLED)
{
		if (self.team_no == 2)
{
			CenterPrint(self, "=== Choose your class ===\n\n“.. Grunt   \n”.. Enforcer\n•.. Vore    \n–.. Ogre    \n—.. Zombie  \n˜.. Shambler\n™.. Fiend   \n›..         \n’..         \n");
			return;
		}
	}
	if (TeamFortress_TeamIsCivilian(self.team_no))
		CSQC_SendMenu(self, self.current_menu, 666, 0);
	else
		CSQC_SendMenu(self, self.current_menu, illegalclasses, TeamFortress_TeamGetIllegalClasses(self.team_no));
	if (TeamFortress_TeamIsCivilian(self.team_no))
	{
		CenterPrint(self, "Your team can only be Civilians.\n");
	}
	else
	{
		if (spy_off == TF_FLARE_OFF)
		{
			CenterPrint(self, "\n\n\n\n\n=== Choose your class ===\n\n“.. Scout   \n”.. Sniper  \n•.. Soldier \n–.. Demoman \n—.. Medic   \n˜.. Hwguy   \n™.. Pyro    \n›.. Engineer\n’.. Randompc\n");
		}
		else
		{
			CenterPrint(self, "\n\n\n\n\n=== Choose your class ===\n\n“‘.. Scout   \n”‘.. Sniper  \n•‘.. Soldier \n–‘.. Demoman \n—‘.. Medic   \n˜‘.. Hwguy   \n™‘.. Pyro    \nš‘.. Spy     \n›‘.. Engineer\n’‘.. Randompc\n");
		}
	}
};
void(float inp) Menu_Class_Input = 
{
	if (inp > 10 || inp < TF_FLARE_OFF)
	{
		return;
	}
	local entity ipl;
	local string minfo;
	if (survival_mode && MONSTER_TEAM_ENABLED)
{
		if (self.team_no == 2)
{
			if (inp > 8)
				return;	// random and class 9 not implemented
			if (Monsterclass_allow(inp) != 1)
{
				sprint(self, 2, "That class is not available on this map.\n");
				return;
			}
		}
	}
	else
if (survival_mode)
{
		ipl = find(world,classname,"monster_score");
		if (ipl != world)
{
			if (ipl.noise1 != "")
				minfo = ipl.noise1;
			ipl.noise1 = strzone(frik_strcat(minfo, " ", infokey(self, "ip")));
			if (minfo != "")
				strunzone(minfo);
		}
		else 
			bprint(2,"ERROR! Player IP List Not Found!!! TELL DEV\n");
	}
	if (!self.playerclass)
		stuffcmd(self, "cmd showmaptop\n");
	self.impulse = inp + 100;
	TeamFortress_ChangeClass();
	ResetMenu();
	if (self.oldcurrentammo != 1)
	{
		self.current_menu = 6;
	}
	self.menu_displaytime = TF_FLARE_LIT;
	self.menu_displaytime -= 10;
	self.impulse = TF_FLARE_LIT;
};
void() Menu_Drop = 
{
	if (self.playerclass == 9)
	{
		CenterPrint(self, "Drop or Make:                   \n“.. Shells                      \n”.. Nails                       \n•.. Rockets                     \n–.. Cells                       \n—.. Nothing                     \n\n");
	}
	else
	{
		CenterPrint(self, "Drop:                           \n“.. Shells                      \n”.. Nails                       \n•.. Rockets                     \n–.. Cells                       \n—.. Nothing                     \n\n");
	}
};
void() Menu_RepeatHelp = 
{
	local string he;
	he = infokey(self, "tf_help");
	if (he != "off")
	{
		CenterPrint2(self, "Press š to see this help again.\n", "New Command: 'mega' for Uber-TF Menu.\n");
	}
};
void (float inp) Menu_Drop_Input =
{
	if (sr_dropgrens)
	{
		if (((inp > 0) && (inp < 7)))
		{
			TeamFortress_DropAmmo (inp);
		}
		if (((inp > 0) && (inp < 8)))
		{
			ResetMenu ();
		}
	}
	else
	{
		if (((inp > 0) && (inp < 5)))
		{
			TeamFortress_DropAmmo (inp);
		}
		if (((inp > 0) && (inp < 6)))
		{
			ResetMenu ();
		}
	}
	self.impulse = 0;
};
void(float inp) Menu_DoBindings_Input = 
{
	if (inp < 4)
	{
		self.impulse = TF_FLARE_LIT;
		if (inp == TF_FLARE_OFF)
		{
			stuffcmd(self, "bind q \"impulse 23\"\n");
			stuffcmd(self, "bind e \"impulse 22\"\n");
			stuffcmd(self, "bind r \"+gren1\"\n");
			stuffcmd(self, "bind f \"+gren2\"\n");
			stuffcmd(self, "bind v \"detpipe\"\n");
			stuffcmd(self, "bind c \"dropammo\"\n");
			stuffcmd(self, "bind x \"scan50\"\n");
			stuffcmd(self, "bind g \"showclasses\"\n");
			stuffcmd(self, "bind z \"inv\"\n");
			self.menu_count = 25;
			self.current_menu = 10;
			self.menu_displaytime = TF_FLARE_LIT;
			return;
		}
		else
		{
			if (inp == 2)
			{
				stuffcmd(self, "bind s \"impulse 23\"\n");
				stuffcmd(self, "bind x \"impulse 22\"\n");
				stuffcmd(self, "bind d \"+gren1\"\n");
				stuffcmd(self, "bind c \"+gren2\"\n");
				stuffcmd(self, "bind f \"detpipe\"\n");
				stuffcmd(self, "bind v \"dropammo\"\n");
				stuffcmd(self, "bind b \"scan50\"\n");
				stuffcmd(self, "bind g \"showclasses\"\n");
				stuffcmd(self, "bind n \"inv\"\n");
				self.menu_count = 25;
				self.current_menu = 11;
				self.menu_displaytime = TF_FLARE_LIT;
				return;
			}
		}
		ResetMenu();
	}
};
void(float inp) Menu_Input = 
{
	if (self.current_menu == 2)
	{
		Menu_Team_Input(inp);
	}
	else
	{
		if (self.current_menu == 3)
		{
			Menu_Class_Input(inp);
		}
		else
		{
			if (self.current_menu == 4)
			{
				Menu_Drop_Input(inp);
			}
			else
			{
				if (self.current_menu == 12)
				{
					Menu_Spy_Input(inp);
				}
				else
				{
					if (self.current_menu == 13)
					{
						Menu_Spy_Skin_Input(inp);
					}
					else
					{
						if (self.current_menu == 14)
						{
							Menu_Spy_Color_Input(inp);
						}
						else
						{
							if (self.current_menu == 15)
							{
								Menu_Engineer_Input(inp);
							}
							else
							{
								if (self.current_menu == 16)
								{
									Menu_EngineerFix_Dispenser_Input(inp);
								}
								else
								{
									if (self.current_menu == 17)
									{
										Menu_EngineerFix_SentryGun_Input(inp);
									}
									else
									{
										if ((self.current_menu == 18))
										{
											Menu_EngineerFix_Tesla_Input (inp);
										}
										else
										{
										if ((self.current_menu == 33))
										{
											Menu_EngineerFix_Teleporter_Input(inp);
										}
										else
										{
										if ((self.current_menu == 34))
										{
											Menu_EngineerFix_Camera_Input(inp);
										}
										else
										{
										if ((self.current_menu == 35))
										{
											Menu_EngineerFix_FieldGen_Input (inp);
										}
										else
										{
										if ((self.current_menu == 40))
										{
											Menu_NewTaunts_Input (inp);
										}
										else
										{
										if ( self.current_menu == 41 )
										{
											Menu_Res_Input (inp);
										}
										else
										{
										if ( self.current_menu == 43 )
										{
											Menu_Merchant_Input (inp);
										}
										else
										{
										if ( self.current_menu == 44 )
										{
											Menu_Blackjack_Input (inp);
										}
										else
										{
#ifdef mtf_coop_quests										
										if ( self.current_menu == 45 )
										{
											Menu_Quest_Input (inp);
										}
										else
										{										
#endif
										if ( self.current_menu == 42 )
										{
											Menu_VoteChoice_Input (inp);
										}
										else
										{
										if (self.current_menu == 19)
										{
											Menu_Dispenser_Input(inp);
										}
										else
										{
											if (self.current_menu == 6)
											{
												Menu_ClassHelp_Input(inp);
											}
											else
											{
												if (self.current_menu == 20)
												{
													Menu_DropStuff_Input(inp);
												}
												else
												{
													if (self.current_menu == 21)
													{
														Menu_Taunt_Input(inp);
													}
													else
													{
														if (self.current_menu == 22)
														{
															Menu_Yell_Input(inp);
														}
														else
														{
															if (self.current_menu == 23)
															{
																Menu_Taunt_Input(inp);
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	} } } } }
	}
	}
	}	// res
	}	// merchant
	}	// blackjack
#ifdef mtf_coop_quests
	}	// quests
#endif
};
void() Menu_DropStuff = 
{
	CenterPrint(self, "€ Mega-TF Menu ‚\n\n€“‚ Drop #1    \n€”‚ Toaster    \n€•‚ Drop #3    \n€–‚ Holograph  \n€—‚ NightVision\n€˜‚ Lay Mode   \n€™‚ Taunt Menu \n€š‚ Yell Menu  \n€›‚ Vote Menu  \n€0‚ Nothing    \n");
};
void(float inp) Menu_DropStuff_Input = 
{
	if (inp == TF_FLARE_OFF)
	{
		stuffcmd(self, "drop1\n");
	}
	else
	{
		if (inp == 2)
		{
			stuffcmd(self, "drop2\n");
		}
		else
		{
			if (inp == 3)
			{
				stuffcmd(self, "drop3\n");
			}
			else
			{
				if (inp == 4)
				{
					stuffcmd(self, "holo\n");
				}
				else
				{
					if (inp == 5)
					{
						stuffcmd(self, "ir\n");
					}
					else
					{
						if (inp == 6)
						{
							stuffcmd(self, "lay\n");
						}
						else
						{
							if (inp == 7)
							{
								ResetMenu();
								self.impulse = TF_FLARE_LIT;
								stuffcmd(self, "taunt\n");
							}
							else
							{
								if (inp == 8)
								{
									ResetMenu();
									self.impulse = TF_FLARE_LIT;
									stuffcmd(self, "yell\n");
								}
								else
								{
									if (inp == 9)
									{
										ResetMenu();
										self.impulse = TF_FLARE_LIT;
										stuffcmd(self, "votemenu\n");
									}
									else
										{
										if (inp > 9)
										{
											ResetMenu();
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	ResetMenu();
	self.impulse = TF_FLARE_LIT;
};
void() Menu_Taunt = 
{
	CenterPrint(self, "€ Taunt Menu ‚\n\n€“‚ R U Threat'n Me?     \n€”‚ Come out w/ pants dwn\n€•‚ Hey!  hehheh...      \n  €–‚ Do U want 2 C my bHole?\n€—‚ Call 911!            \n€˜‚ Kick'm in the Nads!  \n€™‚ I do the a$$ kik'n...\n€š‚ Pathetic Looser!     \n€›‚ Nothing              \n");
};
void() Menu_Yell = 
{
	CenterPrint(self, "€ Yell Menu  ‚\n\n€“‚ Cover Me!            \n€”‚ Over Here!           \n€•‚ This Way!            \n  €–‚ Follow Me!             \n€—‚ Incoming!            \n€˜‚ Holdup!              \n€™‚ Go Go Go!            \n€š‚ Lookout!             \n€›‚ Fire in the hole!    \n");
};
void(float inp) Menu_Taunt_Input = 
{
	if (inp == TF_FLARE_OFF)
	{
		stuffcmd(self, "bic\n");
	}
	else
	{
		if (inp == 2)
		{
			stuffcmd(self, "impulse 250\n");
		}
		else
		{
			if (inp == 3)
			{
				stuffcmd(self, "hey\n");
			}
			else
			{
				if (inp == 4)
				{
					stuffcmd(self, "bhole\n");
						bprint (1, self.netname);
						bprint (1.000000, " would you like to see my bung hole? ehehehehhh!\n");
						sound(self, 2, "speech/getwhiff.wav", TF_FLARE_OFF, TF_FLARE_OFF);
				}
				else
				{
					if (inp == 5)
					{
							bprint (1, self.netname);
							bprint (1.000000, " yells call 911!\n");
							sound(self, 2, "speech/call911.wav", TF_FLARE_OFF, TF_FLARE_OFF);
					}
					else
					{
						if (inp == 6)
						{
							bprint (1, self.netname);
							bprint (1.000000, " kick'em in the nads Beavis!\n");
							sound(self, 2, "speech/kicknads.wav", TF_FLARE_OFF, TF_FLARE_OFF);
						}
						else
						{
							if (inp == 7)
							{
							bprint (1, self.netname);
							bprint (1.000000, " yells I do the ass kicking around here!\n");
							sound(self, 2, "speech/idoasskk.wav", TF_FLARE_OFF, TF_FLARE_OFF);
							}
							else
							{
								if (inp == 8)
								{
#ifdef mtf_coop_birthday
									sound(self, TF_FLARE_OFF, "taunts/makeitso.wav", TF_FLARE_OFF, TF_FLARE_OFF);
#else
									sound(self, 2, "speech/pathetic.wav", 1, 1);
									bprint (1, self.netname);
									bprint (1.000000, " you are one pathetic Luuuuzer!\n");
#endif
								}
								else
								{
									if (inp > 8)
									{
										ResetMenu();
									}
								}
							}
						}
					}
				}
			}
		}
	}
	ResetMenu();
	self.impulse = TF_FLARE_LIT;
};
void(float inp) Menu_Yell_Input = 
{
	WriteByte(4, 23);
	WriteByte(4, 11);
	WriteCoord(4, self.origin_x);
	WriteCoord(4, self.origin_y);
	WriteCoord(4, self.origin_z);
	multicast(self.origin, TF_FLARE_OFF);
	if (inp == TF_FLARE_OFF)
	{
		sound(self, TF_FLARE_OFF, "speech/yell/coverme.wav", TF_FLARE_OFF, TF_FLARE_OFF);
		bprint (1, self.netname);
		bprint (1.000000, " yells cover me!\n");
	}
	else
	{
		if (inp == 2)
		{
		sound(self, TF_FLARE_OFF, "speech/yell/overhere.wav", TF_FLARE_OFF, TF_FLARE_OFF);
		bprint (1, self.netname);
		bprint (1.000000, " yells over here!!\n");
		}
		else
		{
			if (inp == 3)
			{
				bprint (1, self.netname);
				sound(self, TF_FLARE_OFF, "speech/yell/thisway.wav", TF_FLARE_OFF, TF_FLARE_OFF);
				bprint (1.000000, " yells this is the way!!\n");
			}
			else
			{
				if (inp == 4)
				{
					bprint (1, self.netname);
					bprint (1.000000, " yells follow me!\n");
					sound(self, TF_FLARE_OFF, "speech/yell/followme.wav", TF_FLARE_OFF, TF_FLARE_OFF);
				}
				else
				{
					if (inp == 5)
					{
						bprint (1, self.netname);
						bprint (1.000000, " incoming fire!\n");
						sound(self, TF_FLARE_OFF, "speech/yell/incomng.wav", TF_FLARE_OFF, TF_FLARE_OFF);
					}
					else
					{
						if (inp == 6)
						{
							bprint (1, self.netname);
							bprint (1.000000, " yells holdup!!\n");
							sound(self, TF_FLARE_OFF, "speech/yell/holdup.wav", TF_FLARE_OFF, TF_FLARE_OFF);
						}
						else
						{
							if (inp == 7)
							{
								bprint (1, self.netname);
								bprint (1.000000, " yells GO GO GO!\n");
								sound(self, TF_FLARE_OFF, "speech/yell/gogogo.wav", TF_FLARE_OFF, TF_FLARE_OFF);
							}
							else
							{
								if (inp == 8)
								{
									bprint (1, self.netname);
									bprint (1.000000, " yells LOOKOUT!\n");
									sound(self, TF_FLARE_OFF, "speech/yell/lookout.wav", TF_FLARE_OFF, TF_FLARE_OFF);
								}
								else
								{
									if (inp == 9)
									{
										bprint (1, self.netname);
										bprint (1.000000, " yells FIRE IN THE HOLE!\n");
										sound(self, TF_FLARE_OFF, "speech/yell/firehole.wav", TF_FLARE_OFF, TF_FLARE_OFF);
									}
									else
									{
										if (inp > 9)
										{
											ResetMenu();
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	ResetMenu();
	self.impulse = TF_FLARE_LIT;
};
void() Menu_Intro = 
{
	CenterPrint(self, "Welcome to UBER Team Fortress.");
};
void () Menu_ClassHelp =
{
	local string _l_881;

	_l_881 = infokey (self, "tf_help");
	if ((_l_881 != "off"))
	{
		local string mtfver, stats;
		mtfver = infokey(world, "UBERTF");
		mtfver = substr(mtfver, 1, 8);		// cut out the "v" and the "United"

		stats = strcat( ftos(Coop_GetLevel(self.coop_exp)), "\nÅøðº ", ftos(self.coop_exp), strcat("\nåøð ôéìì îåøô ìåöåìº", ftos(Coop_ExpForNextLevel(self.coop_exp))));
		stats = strcat( stats, "\nÇïìä: ", ftos(self.#gold) );
		stats = strzone(stats);

		if ((self.menu_displaytime < 20.000000))
		{
#ifdef mtf_coop_birthday
			CenterPrint6 (self, "Welcome to Uber Team Fortress", 
			#BDAY_MSG,
			mapname, "‘\n\n€ž Ùïõò Óôáôóº ž‚\nÌåöåìº ", stats, "\n\n~Note:~\nÐÌÅÁÓÅ ËÉÌÌ ÁÌÌ ÍÏÎÓÔÅÒÓ\nÂÅÆÏÒÅ ÅØÉÔÉÎÇ¡\n\nFor rules & info use console command:\n ÃÍÄ èåìð\n\nPress š to see these stats again.\n");
#else
#ifdef mtf_coop_halloween
			CenterPrint6 (self, "Welcome to\nn€ž Ùïõò Óôáôóº ž‚\nÌåöåìº", mtfver, "\nHAPPY HALLOWEEN\nCollect potions n stuff!\n\nÍáðº ", mapname, "‘\n\n€ž Ùïõò Óôáôóº ž‚\nÌåöåìº ", stats, "\n\n~Note:~\nÐÌÅÁÓÅ ËÉÌÌ ÁÌÌ ÍÏÎÓÔÅÒÓ\nÂÅÆÏÒÅ ÅØÉÔÉÎÇ¡\n\nFor rules & info use console command:\n ÃÍÄ èåìð\n\nPress š to see these stats again.\n");
#else
			CenterPrint6 (self, "Welcome to\nÍåçáÔÆ Ãï­’ð‘\nö®", mtfver, "\n\nÍáðº ", mapname, "‘\n\n€ž Ùïõò Óôáôóº ž‚\nÌåöåìº ", stats, "\n\n~Note:~\nÐÌÅÁÓÅ ËÉÌÌ ÁÌÌ ÍÏÎÓÔÅÒÓ\nÂÅÆÏÒÅ ÅØÉÔÉÎÇ¡\n\nFor rules & info use console command:\n ÃÍÄ èåìð\n\nPress š to see these stats again.\n");
#endif
		}
		strunzone(stats);
#else
		if ((self.menu_displaytime < 20.000000))
		{
			if ((self.playerclass == 1.000000))
			{
				CenterPrint (self, "ÁÉÒÓÃÏÕÔ  player details:\n ÷åáðïîóº                 \n  “‘ axe                 \n  ”‘ shotgun             \n  –‘ mac-10              \n çòåîáäåóº                \n  +gren“º flash grenade   \n  +gren”º conc grenade    \n äòïðóº                   \n  drop“º flash mine       \n  drop•º disarm detpack   \n ãïííáîäóº                \n  specialº jetpack boost  \n");
			}
			else
			{
				if ((self.playerclass == 2.000000))
				{
					CenterPrint (self, "ÓÎÉÐÅÒ  player details:  \n ÷åáðïîóº                 \n  “‘ axe                 \n  ”‘ sniper rifle        \n  •‘ auto rifle          \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º flare           \n äòïðóº                   \n  drop“º alarm            \n  drop•º call airstrike   \n ãïííáîäóº                \n  specialº autozoom       \n");
				}
				else
				{
					if ((self.playerclass == 3.000000))
					{
						CenterPrint (self, "ÓÏÌÄÉÅÒ  player  details:\n ÷åáðïîóº                 \n  “‘ axe                 \n  ”‘ shotgun             \n  •‘ super shotgun       \n  ™‘ rocket launcher     \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º nail grenade    \n äòïðóº                   \n  drop“º spike trap       \n  drop•º proximity grenade\n ãïííáîäóº                \n  specialº reload         \n");
					}
					else
					{
						if ((self.playerclass == 4.000000))
						{
							CenterPrint (self, "ÄÅÍÏÍÁÎ  player details: \n ÷åáðïîóº                 \n  “‘ axe                 \n  ”‘ shotgun             \n  —‘ long-range gren.    \n  ˜‘ grenade launcher    \n  ™‘ pipebomb launcher   \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º MIRV grenade    \n äòïðóº                   \n  drop“º launch airMIRV   \n ãïííáîäóº                \n  specialº detonate pipes \n  det—º  5 second detpack \n  det”’º 20 second detpack\n  det—’º 50 second detpack\n");
						}
						else
						{
							if ((self.playerclass == 5.000000))
							{
								CenterPrint (self, "ÍÅÄÉÃ  player details:   \n ÷åáðïîóº                 \n  “‘ bioaxe              \n  ”‘ shotgun             \n  •‘ super shotgun       \n  —‘ super nailgun       \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º conc grenade    \n äòïðóº                   \n  drop“º infected syringe \n  drop•º heal self        \n");
							}
							else
							{
								if ((self.playerclass == 6.000000))
								{
									CenterPrint (self, "È×ÇÕÙ  player details:   \n ÷åáðïîóº                 \n  “‘ axe                 \n  ”‘ shotgun             \n  •‘ super shotgun       \n  ™‘ assault cannon      \n  ™‘ 20mm cannon         \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º MIRV grenade    \n äòïðóº                   \n  drop“º spike trap       \n");
								}
								else
								{
									if ((self.playerclass == 7.000000))
									{
										CenterPrint (self, "ÐÙÒÏ  player details:    \n ÷åáðïîóº                 \n  “‘ axe                 \n  ”‘ shotgun             \n  ˜‘ flame-thrower       \n  ™‘ incendiary cannon   \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º napalm grenade  \n äòïðóº                   \n  drop“º lava pool        \n");
									}
									else
									{
										if ((self.playerclass == 8.000000))
										{
											if (spycam)
											{
												CenterPrint (self, "ÓÐÙ  player details:     \n ÷åáðïîóº                 \n  “‘ blade               \n  ”‘ tranquilizer gun    \n  •‘ super shotgun       \n  –‘ mac-10              \n  š‘ grappling hook      \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º gas grenade     \n äòïðóº                   \n  drop“º ammo trap        \n  drop•º spy camera       \n ãïííáîäóº                \n  specialº disguise menu  \n");
											}
											else
											{
												CenterPrint (self, "ÓÐÙ  player details:     \n ÷åáðïîóº                 \n  “‘ blade               \n  ”‘ tranquilizer gun    \n  •‘ super shotgun       \n  –‘ mac-10              \n  š‘ grappling hook      \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º gas grenade     \n äòïðóº                   \n  drop“º ammo trap        \n ãïííáîäóº                \n  specialº disguise menu  \n");
											}
										}
										else
										{
											if ((self.playerclass == 9.000000))
											{
												CenterPrint (self, "ÅÎÇÉÎÅÅÒ  player details:\n ÷åáðïîóº                 \n  “‘ wrench              \n  ”‘ laser gun           \n  •‘ super shotgun       \n çòåîáäåóº                \n  +gren“º normal grenade  \n  +gren”º EMP grenade     \n äòïðóº                   \n  drop“º magnet mine      \n  drop•º laser drone      \n ãïííáîäóº                \n  specialº build menu     \n  dropammoº make ammo menu\n");
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
		else
		{
			if ((self.playerclass == 1.000000))
			{
				CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nFlash Grenade       \nConcussion Grenade  \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nScanner: scan10,scan50,scan250\nJetJump: jetjump\ndrop1 :  drop a Flash mine\n\n\nPress š for alias help\n");
			}
			else
			{
				if ((self.playerclass == 2.000000))
				{
					CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nFlare               \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nautozoom : Toggle Rifle Autozooming\nSet an Alarm   : drop1  \n  Call AirStrike : airstrike\n  SpotLight    : +spot  \n\nPress š for alias help\n");
				}
				else
				{
					if ((self.playerclass == 3.000000))
					{
						CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nNail Grenade        \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nDrop a Spike Trap   : Drop1\ndrop3 : Set a ProxiMine!     \n\n\nPress š for alias help\n");
					}
					else
					{
						if ((self.playerclass == 4.000000))
						{
							CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nMirv Grenade        \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nThe Detpack : det5,det20,det50\nDetonate Pipebombs : detpipe  \nAir-MIRV      : drop1      \n\nPress š for alias help\n");
						}
						else
						{
							if ((self.playerclass == 5.000000))
							{
								CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nConcussion Grenade  \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nHeal Yourself : drop3 or heal\n\n\nPress š for alias help\n");
							}
							else
							{
								if ((self.playerclass == 6.000000))
								{
									CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nMirv Grenade        \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nSet an Spike Trap : drop1  \n\n\nPress š for alias help\n");
								}
								else
								{
									if ((self.playerclass == 7.000000))
									{
										CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nNapalm Grenade      \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nDrop a lava pool  : drop1  \n\n\nPress š for alias help\n");
									}
									else
									{
										if ((self.playerclass == 8.000000))
										{
											CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nHallucinogen Grenade\n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nGo Undercover : disguise\nSet an Ammo Trap : drop1  \n\nPress š for alias help\n");
										}
										else
										{
											if ((self.playerclass == 9.000000))
											{
												CenterPrint (self, "ÇÒÅÎÁÄÅÓ:            \nHand Grenade        \nEMP Grenade         \n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:   \nStart Building : build  \n    Set a Mag Trap : drop1  \n\n\nPress š for alias help\n");
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
#endif
	}
};

void () Menu_StuffClassHelp =
{
	local string _l_902;
	_l_902 = infokey (self, "tf_help");
	if ((_l_902 != "off"))
	{
		if ((self.playerclass == 1.000000))
		{
			sprint (self, 2.000000, "ÓÃÏÕÔ Details:\n×ÅÁÐÏÎÓ:\n   2.. Shotgun\n   4.. MAC-10 \n");
			sprint (self, 2.000000, "ÇÒÅÎÁÄÅÓ:\n   Concussion Grenade\n   Flare\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n");
			sprint (self, 2.000000, "Scanner: scan10,scan30,scan100 .\nJetJump: jetjump\ndrop1 :  drop a Flash mine.\n\n\n");
		}
		else
		{
			if ((self.playerclass == 2.000000))
			{
				sprint (self, 2.000000, "ÓÎÉÐÅÒ Details:\n\n×ÅÁÐÏÎÓ:\n   2.. Sniper Rifle/Auto Rifle\n");
				sprint (self, 2.000000, "4.. MAC-10 \nÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n\n\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n");
				sprint (self, 2.000000, "  autozoom : Toggle Scope Autozooming\n  drop1 : drop an alarm mine.\nairstrike : call an air strike.\n +spot : Toggle SpotLight. \n\n");
			}
			else
			{
				if ((self.playerclass == 3.000000))
				{
					sprint (self, 2.000000, "ÓÏÌÄÉÅÒ Details:\n\n×ÅÁÐÏÎÓ:\n   2.. Shotgun\n   3.. Super Shotgun\n");
					sprint (self, 2.000000, "   7.. Rocket Launcher\nÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n   Nail Grenade\n");
					sprint (self, 2.000000, "ÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n  drop1 : Drop a Spike Trap.  \n  drop3 : Set a ProxiMine!   \n\n\n");
				}
				else
				{
					if ((self.playerclass == 4.000000))
					{
						sprint (self, 2.000000, "ÄÅÍÏÌÉÔÉÏÎÓ ÍÁÎ Details:\n\n×ÅÁÐÏÎÓ:\n   2.. Shotgun\n   5.. Long-range Grenades     \n6.. Grenade Launcher      \n7..Pipebomb Launcher\n");
						sprint (self, 2.000000, "ÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n   Mirv Grenade\n");
						sprint (self, 2.000000, "ÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n   The Detpack : det5,det20,det50\n   Detonate Pipebombs : detpipe\n  drop1 : release an Air MIRV grenade.      \n\n");
					}
					else
					{
						if ((self.playerclass == 5.000000))
						{
							sprint (self, 2.000000, "ÍÅÄÉÃ Details:\n\n×ÅÁÐÏÎÓ:\n   1.. Medikit/BioWeapon\n   2.. Shotgun\n   3.. Super Shotgun\n");
							sprint (self, 2.000000, "   5.. Super Nailgun\nÇÒÅÎÁÄÅÓ:\n   Hand Grenade.\n   Concussion Grenade.\n");
							sprint (self, 2.000000, "ÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n   Drop1 : drop an infected syringe.\n\n\n");
						}
						else
						{
							if ((self.playerclass == 6.000000))
							{
								sprint (self, 2.000000, "ÈÅÁÖÙ ×ÅÁÐÏÎÓ ÇÕÙ Details:\n\n×ÅÁÐÏÎÓ:\n   2.. Shotgun\n   3.. Super Shotgun\n");
								sprint (self, 2.000000, "   7.. Assault Cannon\nÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n");
								sprint (self, 2.000000, "   Mirv Grenade\nÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n  drop1 : Set a spike trap.\n\n\n");
							}
							else
							{
								if ((self.playerclass == 7.000000))
								{
									sprint (self, 2.000000, "ÐÙÒÏ Details:\n\n×ÅÁÐÏÎÓ:\n   2.. Shotgun\n   6.. Flamethrower\n   7.. Incendiary Cannon\n");
									sprint (self, 2.000000, "ÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n   Napalm Grenade\n");
									sprint (self, 2.000000, "ÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n   None\n\n\n");
								}
								else
								{
									if ((self.playerclass == 8.000000))
									{
										sprint (self, 2.000000, "ÓÐÙ Details:\n\n×ÅÁÐÏÎÓ:\n   2.. Tranquiliser Gun\n   3.. Super Shotgun\n   4.. MAC-10 \n   8.. Grapple Hook \n");
										sprint (self, 2.000000, "ÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n   Hallucinogenic Grenade\n");
										sprint (self, 2.000000, "ÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n   Go Undercover : disguise\n  drop1 : Drop an Ammo Trap.\n\n");
									}
									else
									{
										if ((self.playerclass == 9.000000))
										{
											sprint (self, 2.000000, "ÅÎÇÉÎÅÅÒ Details:\n\n×ÅÁÐÏÎÓ:\n   1.. Spanner\n   2.. RailGun\n   3.. Super Shotgun\n");
											sprint (self, 2.000000, "ÇÒÅÎÁÄÅÓ:\n   Hand Grenade\n   EMP Grenade\n");
											sprint (self, 2.000000, "ÓÐÅÃÉÁÌ ÃÏÍÍÁÎÄÓ:\n   Start Building : build\n      Set a Mag Trap : drop1   \n\n\n");
										}
									}
								}
							}
						}
					}
				}
			}
		}
	}
	sprint (self, 2.000000, "Impulse 120 - Launches an auto turret sentry gun.\n");
	sprint (self, 2.000000, "Impulse 189 - You eat a can of Pork and beans for a health boost.\n");
	sprint (self, 2.000000, "impulse  67 - Throws a gravity well bomb.\n");
};
void () Menu_ClassHelp2 =
{
	CenterPrint (self, "ÃÏÍÍÁÎÄÓ                     \n inv      œ Show inventory    \n +gren1   œ Throw grenade 1   \n +gren2   œ Throw Grenade 2   \n reload   œ Force a reload    \n sbar_on  œ Turn on status bar\n autoid_onœ Turn on auto ID   \n dropammo œ drop some ammo    \n discard  œ drop unneeded ammo\n lay      œ start lay mode    \n drop1    œ drop item 1       \n drop2    œ throw a toaster   \n drop3    œ drop item 2       \n mega     œ Mega-TF Menu!     \n dropflag œ drop the flag     \n");
};
void(float inp) Menu_ClassHelp_Input = 
{
	if (inp == 8)
	{
		Menu_ClassHelp2();
		self.menu_count = 25;
		self.current_menu = 7;
		self.menu_displaytime = TF_FLARE_LIT;
		self.impulse = TF_FLARE_LIT;
	}
	if (inp != 8)
	{
		ResetMenu ();
		W_SetCurrentAmmo ();
	}
};
void() Menu_DoBindings = 
{
	CenterPrint(self, "“.. Use keys: E R F V C Q X G Z\n”.. Use keys: S X D C F V B G N\n•.. Don't make bindings        \n");
};
void() Menu_ShowBindings1 = 
{
	CenterPrint(self, "Ñ.. Flaginfo      \nÅ.. Hook          \nÒ.. Throw Gren 1  \nÆ.. Throw Gren 2  \nÖ.. Det. Pipebombs\nÃ.. Drop ammo     \nØ.. Use Scanner   \nÇ.. Showclasses   \nÚ.. inventory     \n");
};
void() Menu_ShowBindings2 = 
{
	CenterPrint(self, "Ó.. Flaginfo      \nØ.. Hook          \nÄ.. Throw Gren 1  \nÃ.. Throw Gren 2  \nÆ.. Det. Pipebombs\nÖ.. Drop ammo     \nÂ.. Use Scanner   \nÇ.. Showclasses   \nÎ.. inventory     \n");
};
void () Menu_Spy =
{
	if (spyjumpoption)
	{
		if (self.is_feigning)
		{
			if (((self.undercover_team != 0.000000) && (self.undercover_skin != 0.000000)))
			{
				CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Reset Skin and Color        \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
			}
			else
			{
				if ((self.undercover_team != 0.000000))
				{
					CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Reset Color                 \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
				}
				else
				{
					if ((self.undercover_skin != 0.000000))
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Reset Skin                  \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
					}
					else
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
					}
				}
			}
		}
		else
		{
			if (((self.undercover_team != 0.000000) && (self.undercover_skin != 0.000000)))
			{
				CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Reset Skin and Color        \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
			}
			else
			{
				if ((self.undercover_team != 0.000000))
				{
					CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Reset Color                 \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
				}
				else
				{
					if ((self.undercover_skin != 0.000000))
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Reset Skin                  \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
					}
					else
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n—.. Change Jump Style           \n˜.. Nothing                     \n\n");
					}
				}
			}
		}
	}
	else
	{
		if (self.is_feigning)
		{
			if (((self.undercover_team != 0.000000) && (self.undercover_skin != 0.000000)))
			{
				CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Reset Skin and Color        \n—.. Nothing                     \n\n");
			}
			else
			{
				if ((self.undercover_team != 0.000000))
				{
					CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Reset Color                 \n—.. Nothing                     \n\n");
				}
				else
				{
					if ((self.undercover_skin != 0.000000))
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Reset Skin                  \n—.. Nothing                     \n\n");
					}
					else
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Stop Feigning               \n–.. Nothing                     \n\n");
					}
				}
			}
		}
		else
		{
			if (((self.undercover_team != 0.000000) && (self.undercover_skin != 0.000000)))
			{
				CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Reset Skin and Color        \n—.. Nothing                     \n\n");
			}
			else
			{
				if ((self.undercover_team != 0.000000))
				{
					CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Reset Color                 \n—.. Nothing                     \n\n");
				}
				else
				{
					if ((self.undercover_skin != 0.000000))
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Reset Skin                  \n—.. Nothing                     \n\n");
					}
					else
					{
						CenterPrint (self, "Action:                           \n“.. Change Skin                 \n”.. Change Color                \n•.. Start Feigning              \n–.. Nothing                     \n\n");
					}
				}
			}
		}
	}
};
void (float inp) Menu_Spy_Input =
{
	if (((self.undercover_team != 0.000000) && (self.undercover_skin != 0.000000)))
	{
		if (inp == 5)
		{
			ResetMenu ();
			self.impulse = 0.000000;
		}
	}
	if (((inp == 1.000000) || (inp == 2.000000)))
	{
		if ((self.effects & 12.000000))
		{
			sprint (self, 2.000000, "You can't go undercover while glowing.\n");
			ResetMenu ();
			self.impulse = 0.000000;
			return;
		}
		if ((self.is_unabletospy == 1.000000))
		{
			sprint (self, 2.000000, "You can't go undercover right now.\n");
			ResetMenu ();
			self.impulse = 0.000000;
			return;
		}
	}
	if ((inp == 1.000000))
	{
		Menu_Spy_Skin ();
		self.menu_count = 25.000000;
		self.current_menu = 13.000000;
		self.menu_displaytime = 0.000000;
		self.impulse = 0.000000;
	}
	else
	{
		if ((inp == 2.000000))
		{
			Menu_Spy_Color ();
			self.menu_count = 25.000000;
			self.current_menu = 14.000000;
			self.menu_displaytime = 0.000000;
			self.impulse = 0.000000;
		}
		else
		{
			if ((inp == 3.000000))
			{
				TeamFortress_SpyFeignDeath (0.000000);
				ResetMenu ();
				self.impulse = 0.000000;
			}
			else
			{
				if ((inp == 4.000000))
				{
					Spy_RemoveDisguise (self);
					ResetMenu ();
					self.impulse = 0.000000;
				}
				else
				{
					if ((inp == 5.000000))
					{
						if (spyjumpoption)
						{
							if ((self.spy_regjump == 1.000000))
							{
								self.spy_regjump = 0.000000;
								sprint (self, 2.000000, "Jump style now high.\n");
							}
							else
							{
								self.spy_regjump = 1.000000;
								sprint (self, 2.000000, "Jump style now disguised.\n");
							}
							ResetMenu ();
							self.impulse = 0.000000;
						}
					}
					else
					{
						if ((((inp == 5.000000) && !spyjumpoption) && ((self.undercover_team != 0.000000) || (self.undercover_skin != 0.000000))))
						{
							ResetMenu ();
							self.impulse = 0.000000;
						}
						else
						{
							if (((inp == 6.000000) && ((self.undercover_team != 0.000000) || (self.undercover_skin != 0.000000))))
							{
								ResetMenu ();
								self.impulse = 0.000000;
							}
						}
					}
				}
			}
		}
	}
};
void() Menu_Spy_Skin = 
{
	CenterPrint(self, "Change Skin to:\n“.. Scout   \n”.. Sniper  \n•.. Soldier \n–.. Demoman \n—.. Medic   \n˜.. Hwguy   \n™.. Pyro    \nš.. Spy     \n›.. Engineer\n\n");
};
void(float inp) Menu_Spy_Skin_Input = 
{
	if (inp < 10 && inp > TF_FLARE_LIT)
	{
		TeamFortress_SpyChangeSkin(inp);
		ResetMenu();
		self.impulse = TF_FLARE_LIT;
	}
};
void() Menu_Spy_Color = 
{
				CenterPrint(self, "=== Change Color to the Same Color as  ===\n\n“.. Team One  \n”.. Team Two  \n•.. Team Three\n–.. Team Four \n\n");
};
void(float inp) Menu_Spy_Color_Input = 
{
	if (inp >= TF_FLARE_OFF && inp <= number_of_teams)
	{
		TeamFortress_SpyChangeColor(inp);
		ResetMenu();
		self.impulse = TF_FLARE_LIT;
	}
};
void () Menu_Engineer =
{
	local string line1;
	local string line2;
	local string line3;
	local string line4;
	local string line5;
	local string fieldgen;
	local string miscgen; 
	if ((self.has_dispenser == TF_FLARE_OFF))
	{
		line1 = "“.. Destroy Dispenser             \n";
	}
	else
	{
		if ((self.ammo_cells >= 100))
		{
			line1 = "“.. Build Ammo&Armor Dispenser    \n";
		}
		else
		{
			line1 = "                                  \n";
		}
	}
	if ((self.has_sentry == TF_FLARE_OFF))
	{
		line2 = "”.. Destroy Sentry Gun            \n";
	}
	else
	{
		if ((self.ammo_cells >= 130))
		{
			line2 = "”.. Build Sentry Gun              \n";
		}
		else
		{
			line2 = "                                  \n";
		}
	}
	if (self.classname == "player")
{
	if ((self.has_tesla == TF_FLARE_OFF))
	{
		line3 = "•.. Destroy Tesla Sentry Gun      \n";
	}
	else
	{
		if ((self.ammo_cells >= 150))
		{
			line3 = "•.. Build Tesla Sentry Gun        \n";
		}
		else
		{
			line3 = "                                  \n";
		}
	} }
	if (self.has_camera == 1)
		line4 = "®® Destroy Security Camera       \n"; //CH impulse 4 for both
	else
if (self.ammo_cells >= 55)
		line4 = ".. Launch Security Camera        \n";
	else
		line4 = "                                  \n";
	if (infokey(world, "telepads") == "1")
{
	if (self.has_teleporter != 0) //CH messy, yes
	{
		if (self.has_teleporter == 1 && self.ammo_cells >= 90)
			line5 = ".. Build a Teleporter Pad        \n®® Destroy a Teleporter Pad      \n";
		else
if (self.has_teleporter == 1 && self.ammo_cells < 90)
			line5 = "®® Destroy a Teleporter Pad      \n"; // 6
		if (self.has_teleporter == 2)
			line5 = ".. Destroy your last Teleporter  \n®® Destroy Both Teleporter Pads  \n"; // 5, 6
		}
	else
if (self.ammo_cells >= 90)
		line5 = ".. Build a Teleporter Pad        \n                                  \n";
	else
		line5 = "                                  \n";
	}
	if ((self.ammo_cells >= 150))
	{
		fieldgen = "•.. Build Field Generator           \n";
	}
	if ((self.has_fieldgen >= 2))
	{
		fieldgen = "•.. Remotely Detonate FieldGens     \n";
	}
	if ((self.has_fieldgen == TF_FLARE_OFF))
	{
		miscgen = "’.. Remotely Detonate First FieldGen\n";
	}
	if ((self.has_fieldgen >= 2))
	{
		miscgen = "’.. Reset/Shutdown FieldGens        \n";
	}
	if (infokey(world, "fieldgens") == "1")
{
		centerprint (self, "Action:                           \n", line1, line2, line3, line5, fieldgen, ".. Nothing                       \n\n");
		return;
	}
	if (infokey(world, "telepads") == "1")
{
		centerprint (self, "Action:                           \n", line1, line2, line3, line4, line5, ".. Nothing                       \n\n");
	}
	else
	{
		centerprint (self, "Action:                           \n", line1, line2, line3, "–.. Nothing                       \n\n");
	}
};
void(float inp) Menu_Engineer_Input = 
{
	local entity te;
	if (infokey(world, "telepads") == "1")
{
		if ((inp == 7))
		{
			ResetMenu ();
			self.impulse = TF_FLARE_LIT;
		}
	}
	if (infokey(world, "telepads") != "1")
{
		if ((inp == 4))
		{
			ResetMenu ();
			self.impulse = TF_FLARE_LIT;
		}
	}
	if (infokey(world, "telepads") == "1")
{
	if (inp == 4)
	{
		if (!(self.ammo_cells >= 55))
		{
			ResetMenu ();
			self.impulse = TF_FLARE_LIT;
		}
		if (!self.has_camera)
			TeamFortress_Build(4);
		else
		{
		te = find (world, classname, "building_camera");
		while (te)
		{
			if ((te.real_owner == self))
			{
				TF_T_Damage (te, world, world, 500, TF_FLARE_LIT, TF_FLARE_LIT);
		                self.impulse = 0;
	        	        return;
			}
			te = find (te, classname, "building_camera");
		}
		ResetMenu();
		self.impulse = 0;
		}
		}
	}
	if (inp == 5 && (self.has_teleporter == 0 || self.has_teleporter == 1 || self.has_teleporter == 2) && self.ammo_cells >= 90 && infokey(world, "telepads") == "1") //ch if have one out, can build
	{
		if (self.has_teleporter == 1)
		{
				local float r;
				te = find(world, classname, "building_teleporter");
				while (te)
				{
					if (te.real_owner == self)
					{
						r = vlen(te.origin - self.origin);
						if (r > 8072)
						{
							sprint(self, 2, "Other Teleporter is too far away.\n");
				return;
						}
						else
						{
							TeamFortress_Build(5);
							ResetMenu();
							self.impulse = 0;
						}
					}
					te = find(te, classname, "building_teleporter");
				}	
		}
		else
if (self.has_teleporter == 2)
		{
				te = find(world, classname, "building_teleporter");
				while (te)
				{
					if (te.real_owner == self && te.has_teleporter == 2)
					{
						TF_T_Damage (te, world, world, 500, TF_FLARE_LIT, TF_FLARE_LIT);
					}
					te = find(te, classname, "building_teleporter");
				}
		}
		else
		{
			TeamFortress_Build(5);
			ResetMenu();
			self.impulse = 0;
		}
	}
	if (inp == 6 && (self.has_teleporter == 1 || self.has_teleporter == 2)) //ch if have one out. can destroy
	{
		te = find (world, classname, "building_teleporter");
		while (te)
		{
			if ((te.real_owner == self))
			{
				TF_T_Damage (te, world, world, 500, TF_FLARE_LIT, TF_FLARE_LIT);
			}
			te = find (te, classname, "building_teleporter");
		}
		ResetMenu();
		self.impulse = TF_FLARE_LIT;
	}
	if (((inp == 8) && (((self.ammo_cells >= 150) && (self.has_fieldgen <= TF_FLARE_OFF)) || (self.has_fieldgen >= 2))))
	if (infokey(world, "fieldgens") == "1")
{
	{
		if ((self.has_fieldgen >= 2))
		{
			te = find (world, classname, "building_fieldgen");
			while (te)
			{
				if ((te.real_owner == self))
				{
					TF_T_Damage (te, world, world, 500, TF_FLARE_LIT, TF_FLARE_LIT);
				}
				te = find (te, classname, "building_fieldgen");
			}
			self.has_fieldgen = TF_FLARE_LIT;
		}
		else
		{
			TeamFortress_Build (8);
		}
		ResetMenu ();
		self.impulse = TF_FLARE_LIT;
	}
	}
	if (inp == TF_FLARE_OFF && (self.ammo_cells >= 100 || self.has_dispenser == TF_FLARE_OFF))
	{
		if (self.has_dispenser)
		{
			te = find(world, classname, "building_dispenser");
			while (te)
			{
				if (te.real_owner == self)
				{
					local float damg;
					damg = te.ammo_cells * 0.25;
					damg = damg + te.ammo_nails * 0.1;
					damg = damg + te.ammo_shells * 0.2;
					damg = damg + te.ammo_rockets * 1.75;
					damg = damg * 4;
					deathmsg = 201;
					T_RadiusDamage(te, te.real_owner, damg, world);
					TF_T_Damage(te, world, world, 500, TF_FLARE_LIT, TF_FLARE_LIT);
				}
				te = find(te, classname, "building_dispenser");
			}
		}
		else
		{
			sound(self, 3, "items/repair.wav", TF_FLARE_OFF, TF_FLARE_OFF);
			TeamFortress_Build(TF_FLARE_OFF);
		}
		ResetMenu();
		self.impulse = TF_FLARE_LIT;
	}
	else
	{
		if (inp == 2 && (self.ammo_cells >= 130 || self.has_sentry == TF_FLARE_OFF))
		{
			if (self.has_sentry)
			{
				te = find(world, classname, "building_sentrygun");
				while (te)
				{
					if (te.real_owner == self)
					{
						TF_T_Damage(te, world, world, 500, TF_FLARE_LIT, TF_FLARE_LIT);
					}
					te = find(te, classname, "building_sentrygun");
				}
				self.has_sentry = 0;
			}		
			else
if (self.has_tesla == 1 && self.ammo_attr < 7)
{
				sprint(self,2,"Upgrade your ammo attributes to 7 to allow dual sentry buildings.\n");
			}
			else
			{
				sound(self, 3, "items/repair.wav", TF_FLARE_OFF, TF_FLARE_OFF);
				TeamFortress_Build(2);
			}
			ResetMenu();
			self.impulse = TF_FLARE_LIT;
		}
		else
		{
			if (self.classname == "player")
{
			if (((inp == 3) && ((self.ammo_cells >= 150) || (self.has_tesla == 1))))
			{
				if (self.has_tesla)
				{
					te = find (world, classname, "building_tesla");
					while (te)
					{
						if ((te.real_owner == self))
						{
							TF_T_Damage (te, world, world, 5000, TF_FLARE_LIT, TF_FLARE_LIT);			// Seems like teslas can have more health than that?
						}
						te = find (te, classname, "building_tesla");
					}
					self.has_tesla = 0;			// HACK so players can rebuild tesla when it falls outta the map
				}
				else
if (self.has_sentry == 1 && self.ammo_attr < 7)
{
					sprint(self,2,"Upgrade your ammo attributes to 7 to allow dual sentry buildings.\n");
				}
				else
				{
					sound (self, 3, "items/repair.wav", TF_FLARE_OFF, TF_FLARE_OFF);
					TeamFortress_Build (3);
				}
				ResetMenu ();
				self.impulse = TF_FLARE_LIT;
			} }
			else
			{
				if ((inp == 4))
				{
					ResetMenu ();
					self.impulse = TF_FLARE_LIT;
				}
				if (infokey(world, "telepads") == "1")
{
					if ((inp == 7))
					{
						ResetMenu ();
						self.impulse = TF_FLARE_LIT;
					}
				}
			}
		}
	}
};
void () Menu_EngineerFix_FieldGen =
{
	CenterPrint (self, "Action:                               \n“.. Repair FieldGen                \n\n\n\n\n˜.. Nothing                        \n\n\n\n’.. Dismantle FieldGen             \n");
};
void (float inp) Menu_EngineerFix_FieldGen_Input =
{
	local float metalcost;
	local entity te;
	if (((self.classname != "player") || (self.building == world)))
	{
		return;
	}
	if ((inp == TF_FLARE_OFF))
	{
		metalcost = ((self.building.max_health - self.building.health) / 5);
		if ((metalcost > self.ammo_cells))
		{
			metalcost = self.ammo_cells;
		}
		self.ammo_cells = (self.ammo_cells - metalcost);
		self.building.health = (self.building.health + (metalcost * 5));
	}
	else
	{
		if ((inp == 10))
		{
			sprint (self, 2, "You dismantle the Field Generator.\n");
			self.ammo_cells = (self.ammo_cells + (150 / 2));
			te = find (world, classname, "force_field");
			while (te)
			{
				if (((te.owner == self.building) || (te.gen_slave == self.building)))
				{
					if ((te.owner == self.building))
					{
						te.owner = world;
					}
					if ((te.gen_slave == self.building))
					{
						te.real_owner = world;
					}
					te.nextthink = (time + 0.1);
				}
				te = find (te, classname, "force_field");
			}
			if ((self.building.gen_north != world))
			{
				self.building.gen_north.gen_south = world;
			}
			if ((self.building.gen_south != world))
			{
				self.building.gen_south.gen_north = world;
			}
			if ((self.building.gen_east != world))
			{
				self.building.gen_east.gen_west = world;
			}
			if ((self.building.gen_west != world))
			{
				self.building.gen_west.gen_east = world;
			}
			dremove (self.building);
			self.building.real_owner.has_fieldgen = (self.building.real_owner.has_fieldgen - TF_FLARE_OFF);
		}
	}
	if ((((inp == TF_FLARE_OFF) || (inp == 6)) || (inp == 10)))
	{
		ResetMenu ();
		self.impulse = TF_FLARE_LIT;
		bound_other_ammo (self);
		if ((self.armorvalue == TF_FLARE_LIT))
		{
			self.armortype = TF_FLARE_LIT;
			self.armorclass = TF_FLARE_LIT;
			self.items = (self.items - (self.items & ((8192 | 16384) | 32768)));
		}
		W_SetCurrentAmmo ();
	}
};
void() Menu_EngineerFix_Dispenser = 
{
	if (self.has_turretized_tesla == 1)
	{
		CenterPrint(self, "Action:                            \n“‘.. Put Ammo into Dispenser     \n”‘.. Put Armor into Dispenser    \n•‘.. Repair Dispenser            \n–‘.. Dismantle Dispenser         \n—‘.. Access Turretized Tesla     \n˜‘.. Nothing                     \n\n");
	}
	else
	{
	CenterPrint(self, "Action:                            \n“‘.. Put Ammo into Dispenser     \n”‘.. Put Armor into Dispenser    \n•‘.. Repair Dispenser            \n–‘.. Dismantle Dispenser         \n—‘.. Nothing                     \n\n");
	}
};
void(float inp) Menu_EngineerFix_Dispenser_Input = 
{
	local float metalcost;
	local float am;
	if (self.classname != "player" || self.building == world)
	{
		return;
	}
	if (self.has_turretized_tesla == 1) 
	{
		if (inp == 5)
		{
			local entity thetesla;
			local entity te;
			te = find (world, classname, "building_tesla");
			while (te)
			{
				if ((te.real_owner == self))
				{
					thetesla = findradius(te.origin, 550);
					while (thetesla)
					{
						if (thetesla.classname == "building_dispenser" && thetesla.real_owner == self)
						{
							ResetMenu();
							self.impulse = TF_FLARE_LIT;
								local string st;

		if ((te.ammo_rockets == TF_FLARE_LIT))
		{
			te.maxammo_cells = 120;
		}
		else
		{
			if ((te.ammo_rockets == TF_FLARE_OFF))
			{
				te.maxammo_cells = 120;
			}
			else
			{
				if ((te.ammo_rockets == 2))
				{
					te.maxammo_cells = 200;
				}
				else
				{
					if ((te.ammo_rockets == 3))
					{
						te.maxammo_cells = 300;
					}
				}
			}
		}
		te.maxammo_cells = te.maxammo_cells + te.cells_bonus;
	sprint(self, #PRINT_HIGH, "Èåáìôè:");
	st = ftos(te.health);
	sprint(self, #PRINT_HIGH, st);
	sprint(self, #PRINT_HIGH, "¯");
	st = ftos(te.max_health);
	sprint(self, #PRINT_HIGH, st);
	sprint(self, #PRINT_HIGH, " Ãåììó:");
	st = ftos(te.ammo_cells);
	sprint(self, #PRINT_HIGH, st);
	sprint(self, #PRINT_HIGH, "¯");
	st = ftos(te.maxammo_cells);
	sprint(self, #PRINT_HIGH, st);
	st = ftos ((6 - te.currentammo));
	sprint(self, #PRINT_HIGH, " Õðçòáäåó Ìåæô:");
	sprint (self, 2, st);
	st = ftos ((6 - te.currentammo));
	sprint (self, 2, "\n");
	sprint(self, #PRINT_HIGH, "Öïìôáçå:");
	st = ftos(te.ammo_shells);
	sprint(self, #PRINT_HIGH, st);
	sprint(self, #PRINT_HIGH, " Áíðåòáçå:");
	st = ftos(te.ammo_nails);
	sprint(self, #PRINT_HIGH, st);
	sprint(self, #PRINT_HIGH, " Ðï÷åò Óõððìù:");
	st = ftos(te.ammo_rockets);
	sprint(self, #PRINT_HIGH, st);
	sprint(self, #PRINT_HIGH, "\n");
	if (te.tf_items)
	{
		if ((te.tf_items & 2))
		{
			sprint (self, 2, "TeslaTurret(tm) ");
		}
		if ((te.tf_items & TF_FLARE_OFF))
		{
			sprint (self, 2, "Improved Targeter ");
		}
		if ((te.tf_items & 1024))
		{
			sprint (self, 2, "Spy Detector");
		}
		sprint (self, 2, "\n");
	}
							self.building = te;
							self.current_menu = 18;
							return;
						}
						thetesla = thetesla.chain;
					}
					sprint(self, 2, "You're too far away from your tesla.\n");
				}
				te = find (te, classname, "building_tesla");
			}

		}
	}
	if (inp == TF_FLARE_OFF)
	{
		am = 20 * 2;
		if (am > self.ammo_shells)
		{
			am = self.ammo_shells;
		}
		if (am > 400 - self.building.ammo_shells)
		{
			am = 400 - self.building.ammo_shells;
		}
		self.ammo_shells = self.ammo_shells - am;
		self.building.ammo_shells = self.building.ammo_shells + am;
		am = 20 * 2;
		if (am > self.ammo_nails)
		{
			am = self.ammo_nails;
		}
		if (am > 600 - self.building.ammo_nails)
		{
			am = 600 - self.building.ammo_nails;
		}
		self.ammo_nails = self.ammo_nails - am;
		self.building.ammo_nails = self.building.ammo_nails + am;
		am = 10 * 2;
		if (am > self.ammo_rockets)
		{
			am = self.ammo_rockets;
		}
		if (am > 300 - self.building.ammo_rockets)
		{
			am = 300 - self.building.ammo_rockets;
		}
		self.ammo_rockets = self.ammo_rockets - am;
		self.building.ammo_rockets = self.building.ammo_rockets + am;
		am = 10 * 2;
		if (am > self.ammo_cells)
		{
			am = self.ammo_cells;
		}
		if (am > 400 - self.building.ammo_cells)
		{
			am = 400 - self.building.ammo_cells;
		}
		self.ammo_cells = self.ammo_cells - am;
		self.building.ammo_cells = self.building.ammo_cells + am;
	}
	else
	{
		if (inp == 2)
		{
			am = 40 * 2;
			if (am > self.armorvalue)
			{
				am = self.armorvalue;
			}
			if (am > 500 - self.building.armorvalue)
			{
				am = 500 - self.building.armorvalue;
			}
			self.armorvalue = self.armorvalue - am;
			self.building.armorvalue = self.building.armorvalue + am;
		}
		else
		{
			if (inp == 3)
			{
				sound(self, 3, "items/repair.wav", TF_FLARE_OFF, TF_FLARE_OFF);
				metalcost = (self.building.max_health - self.building.health) / 5;
				if (metalcost > self.ammo_cells)
				{
					metalcost = self.ammo_cells;
				}
				self.ammo_cells = self.ammo_cells - metalcost;
				self.building.health = self.building.health + metalcost * 5;
			}
			else
			{
				if (inp == 4)
				{
					sprint(self, 2, "You dismantle the Dispenser.\n");
					self.ammo_cells = self.ammo_cells + 100 / 2;
					dremove(self.building);
					self.building.real_owner.has_dispenser = TF_FLARE_LIT;
				}
			}
		}
	}
	if (inp >= TF_FLARE_OFF && inp <= 6)
	{
		ResetMenu();
		self.impulse = TF_FLARE_LIT;
		self.building = world;
		bound_other_ammo(self);
		if (self.armorvalue == TF_FLARE_LIT)
		{
			self.armortype = TF_FLARE_LIT;
			self.armorclass = TF_FLARE_LIT;
			self.items = self.items - (self.items & (8192 | 16384 | 32768));
		}
		W_SetCurrentAmmo();
	}
};
void () Menu_EngineerFix_SentryGun =
{
	if (((self.building.weapon < 3.000000) && (self.ammo_cells >= 130.000000)))
	{
		CenterPrint (self, "Action:                            \n“‘.. Put Ammo into Sentry Gun    \n”‘.. Upgrade Sentry Gun          \n•‘.. Repair Sentry Gun           \n–‘.. Dismantle Sentry Gun        \n—‘.. Nothing                     \n                                  \n6‘.. Rotate Clockwise            \n\n");
	}
	else
	{
		if ((self.building.weapon == 3.000000))
		{
			if (self.building.#sentry_power == 0)
				CenterPrint (self, "Action:                            \n“‘.. Put Ammo into Sentry Gun    \n\n•‘.. Repair Sentry Gun           \n–‘.. Dismantle Sentry Gun        \n—‘.. Nothing                     \n                                  \n6‘.. Rotate Clockwise            \n7‘.. Unload Rockets              \n\n8‘.. Upgrade To Fire Sentry      \n9‘.. Upgrade to Seeker Sentry    \n0‘.. Upgrade to Quad Sentry      \n\n");
			else
				CenterPrint (self, "Action:                            \n“‘.. Put Ammo into Sentry Gun    \n\n•‘.. Repair Sentry Gun           \n–‘.. Dismantle Sentry Gun        \n—‘.. Nothing                     \n                                  \n6‘.. Rotate Clockwise            \n7‘.. Unload Rockets              \n\n");
		}
		else
		{
			CenterPrint (self, "Action:                            \n“‘.. Put Ammo into Sentry Gun    \n\n•‘.. Repair Sentry Gun           \n–‘.. Dismantle Sentry Gun        \n—‘.. Nothing                     \n                                  \n6‘.. Rotate Clockwise            \n\n");
		}
	}
};
void (float inp) Menu_EngineerFix_SentryGun_Input =
{
	local float am;
	local float metalcost;
	local string st;
	if (((self.classname != "player") || (self.building == world)))
	{
		return;
	}
	if ((inp == 1.000000))
	{
		am = 40.000000;
		if ((am > self.ammo_shells))
		{
			am = self.ammo_shells;
		}
		if ((am > (self.building.maxammo_shells - self.building.ammo_shells)))
		{
			am = self.building.maxammo_shells - self.building.ammo_shells;
		}
		self.ammo_shells = (self.ammo_shells - am);
		self.building.ammo_shells = (self.building.ammo_shells + am);
		if ((self.building.weapon == 3.000000))
		{
			am = 20.000000;
			if ((am > self.ammo_rockets))
			{
				am = self.ammo_rockets;
			}
			if ((am > (self.building.maxammo_rockets - self.building.ammo_rockets)))
			{
				am = self.building.maxammo_rockets - self.building.ammo_rockets;
			}
			self.ammo_rockets = (self.ammo_rockets - am);
			self.building.ammo_rockets = (self.building.ammo_rockets + am);
		}
	}
	else
	{
		if ((((self.building.weapon < 3.000000) && (inp == 2.000000)) && (self.ammo_cells >= 130.000000)))
		{
			self.ammo_cells = (self.ammo_cells - 130.000000);
			self.building.weapon = (self.building.weapon + 1.000000);
			self.building.max_health = (self.building.max_health * 1.200000);
			self.building.health = self.building.max_health;
			self.building.maxammo_shells = (self.building.maxammo_shells * 1.200000);
			if ((self.building.weapon == 2.000000))
			{
				sound (self.building, 3.000000, "weapons/tnkatck4.wav", 1.000000, 1.000000);
				self.building.think = lvl2_sentry_stand;
				self.building.skin = 1.000000;
			}
			else
			{
				sound (self.building, 3.000000, "weapons/tnkatck4.wav", 1.000000, 1.000000);
				self.building.think = lvl3_sentry_stand;
				self.building.skin = 2.000000;
			}
			sprint (self, 2.000000, "You upgrade the Sentry Gun to level ");
			st = ftos (self.building.weapon);
			sprint (self, 2.000000, st);
			sprint (self, 2.000000, ".\n");
			if (((self.client == "fuhquake") || (self.client == "zquake")))
			{
				stuffcmd (self, "set $sentryhealth ");
				stuffcmd (self, ftos (rint (self.building.health)));
				stuffcmd (self, "\n");
			}
		}
		else
		{
			if ((inp == 3.000000))
			{
				metalcost = (self.building.max_health - self.building.health) / 5.000000;
				if ((metalcost > self.ammo_cells))
				{
					metalcost = self.ammo_cells;
				}
				if (metalcost)
					Achievements_Change( self, world, ACHIEVEMENTS_ADD, ACHIEVEMENT_REPAIR, 1 );
				sound (self, 3.000000, "items/repair.wav", 1.000000, 1.000000);
				self.ammo_cells = (self.ammo_cells - metalcost);
				self.building.health = (self.building.health + (metalcost * 5.000000));
				if (((self.client == "fuhquake") || (self.client == "zquake")))
				{
					stuffcmd (self, "set $sentryhealth ");
					stuffcmd (self, ftos (rint (self.building.health)));
					stuffcmd (self, "\n");
				}
			}
			else
			{
				if ((inp == 4.000000))
				{
					sprint (self, 2.000000, "You dismantle the Sentry Gun.\n");
					if ((self.building.real_owner != self))
					{
						sprint (self.building.real_owner, 2.000000, self.netname);
						sprint (self.building.real_owner, 2.000000, " has dismantled your sentry gun.\n");
						bprint (1.000000, self.netname);
						if ((self.building.real_owner.team_no == self.team_no))
						{
							bprint (1.000000, " dismantled teammate ");
						}
						else
						{
							bprint (1.000000, " humiliated ");
						}
						bprint (1.000000, self.building.real_owner.netname);
						bprint (1.000000, "'s sentry gun.\n");
					}
					self.ammo_cells = (self.ammo_cells + 65.000000);
					dremove (self.building.trigger_field);
					dremove (self.building);
					self.building.real_owner.has_sentry = 0.000000;
					if (((self.client == "fuhquake") || (self.client == "zquake")))
					{
						stuffcmd (self, "set $sentryhealth 0\n");
					}
				}
				else
				{
					if ((inp == 6.000000))
					{
						sprint (self, 2.000000, "Rotating 45 degrees clockwise...\n");
						self.building.waitmin = anglemod ((self.building.waitmin - 45.000000));
						self.building.waitmax = anglemod ((self.building.waitmax - 45.000000));
					}
					if ((inp == 7.000000))
					{
						self.ammo_rockets = (self.ammo_rockets + self.building.ammo_rockets);
						if ((self.ammo_rockets > self.maxammo_rockets))
						{
							self.ammo_rockets = self.maxammo_rockets;
						}
						self.building.ammo_rockets = 0.000000;
						sprint (self, 2.000000, "You have unloaded your sentry's rocket cache.\n");
					}
				}
			}
		}
	}
	if (self.building.weapon == 3 && self.building.#sentry_power == 0)
{
		if (inp == 8 || inp == 9 || inp == 10)
{
			if (self.ammo_cells < 120)
{
				sprint(self, 2, "You need 120 cells to upgrade your sentrygun's power.\n");
			}
			else
if (lms_entity != world)
{
				sprint(self, 2, "Not available in LMS mode.\n");
			}
			else
	{
				self.ammo_cells = (self.ammo_cells - 120);
				if (inp == 8)
{
					self.building.#sentry_power = #SENTRY_FLAME;
					self.building.effects |= EF_RED;
					sprint (self, 2, "You have upgraded your sentrygun to shoot FIRE.\n");
				}
				else
if (inp == 9)
{
					self.building.#sentry_power = #SENTRY_SEEKER;
					self.building.effects |= EF_GREEN;
					sprint (self, 2, "You have upgraded your sentrygun to shoot SEEKERS.\n");
				}
				else
if (inp == 10)
{
					self.building.#sentry_power = #SENTRY_QUAD;
					self.building.effects |= 64;//EF_BLUE;
					sprint (self, 2, "You have upgraded your sentrygun to inflict QUAD damage.\n");
				}
			}
		}
	}
	if (((inp >= 1.000000) && (inp <= 11.000000)))
	{
		ResetMenu ();
		self.impulse = 0.000000;
		bound_other_ammo (self);
		if ((self.armorvalue == 0.000000))
		{
			self.armortype = 0.000000;
			self.armorclass = 0.000000;
			self.items = (self.items - (self.items & 57344.000000));
		}
		W_SetCurrentAmmo ();
	}
};
void () Menu_EngineerFix_Tesla =
{
	if (infokey(world, "balancedtesla") == "1")
{
	CenterPrint (self, "Tesla Modification Lab: – Upgrades Max\n.. Upgrade Voltage           - 1u\n.. Upgrade Amperage          - 1u\n•.. Upgrade Power Supply      - 1u\n–.. Make TeslaTurret(tm)      - 2u\n—.. Improved Targeting System - 2u\n˜.. Add Spy Detector          - 2u\n.. Repair and Recharge           \n.. Dismantle                     \n›.. Tinker Tesla                  \n’.. Îïôèéîç                       ");
	}
	else
	{
	CenterPrint (self, "Tesla Modification Lab: ˜ Upgrades Max\n.. Upgrade Voltage           - 1u\n.. Upgrade Amperage          - 1u\n•.. Upgrade Power Supply      - 1u\n–.. Make TeslaTurret(tm)      - 2u\n—.. Improved Targeting System - 2u\n˜.. Add Spy Detector          - 4u\n.. Repair and Recharge           \n.. Dismantle                     \n›.. Tinker Tesla                  \n’.. Îïôèéîç                       ");
	}
};
void (float inp) Menu_EngineerFix_Tesla_Input =
{
	local float cost;
	local float maxcells;
	if (((self.classname != "player") || (self.building == world)))
	{
		return;
	}
	if ((inp == 1))
	{
		if ((self.building.ammo_shells >= 3))
		{
			sprint (self, 2, "You can only upgrade voltage 3 times.\n");
		}
		else
		{
			if ((self.building.currentammo >= 6))
			{
				sprint (self, 2, "You can only have ˜ upgrades on the gun.\n");
			}
			else
			{
				if ((self.ammo_cells >= 100))
				{
					self.ammo_cells = (self.ammo_cells - 100);
					self.building.ammo_shells = (self.building.ammo_shells + 1);
					self.building.waitmin = ((self.building.ammo_shells + 2) * (self.building.ammo_nails + 2));
					self.building.currentammo = (self.building.currentammo + 1);
				}
				else
				{
					sprint (self, 2, "You need more cells to upgrade the tesla.\n");
				}
			}
		}
	}
	if ((inp == 2))
	{
		if ((self.building.ammo_nails >= 3))
		{
			sprint (self, 2, "You can only upgrade amperage 3 times.\n");
		}
		else
		{
			if ((self.building.currentammo >= 6))
			{
				sprint (self, 2, "You can only have ˜ upgrades on the gun.\n");
			}
			else
			{
				if ((self.ammo_cells >= 100))
				{
					self.ammo_cells = (self.ammo_cells - 100);
					self.building.ammo_nails = (self.building.ammo_nails + 1);
					self.building.waitmin = ((self.building.ammo_shells + 2) * (self.building.ammo_nails + 2));
					self.building.currentammo = (self.building.currentammo + 1);
				}
				else
				{
					sprint (self, 2, "You need more cells to upgrade the tesla.\n");
				}
			}
		}
	}
	if ((inp == 3))
	{
		if ((self.building.ammo_rockets >= 3))
		{
			sprint (self, 2, "You can only upgrade the capacitor 3 times.\n");
		}
		else
		{
			if ((self.building.currentammo >= 6))
			{
				sprint (self, 2, "You can only have ˜ upgrades on the gun.\n");
			}
			else
			{
				if ((self.ammo_cells >= 100))
				{
					self.ammo_cells = (self.ammo_cells - 100);
					self.building.ammo_rockets = (self.building.ammo_rockets + 1);
					self.building.currentammo = (self.building.currentammo + 1);
					if ((self.building.ammo_rockets == 1))
					{
						self.building.max_health = (self.building.max_health + 100);
						self.building.health = (self.building.health + 100);
						self.building.ammo_cells = 120;
					}
					else
					{
						if ((self.building.ammo_rockets == 2))
						{
							self.building.max_health = (self.building.max_health + 150);
							self.building.health = (self.building.health + 150);
							self.building.ammo_cells = 200;
						}
						else
						{
							if ((self.building.ammo_rockets == 3))
							{
								self.building.max_health = (self.building.max_health + 150);
								self.building.health = (self.building.health + 150);
								self.building.ammo_cells = 300;
							}
						}
					}
				}
				else
				{
					sprint (self, 2, "You need more cells to upgrade the tesla.\n");
				}
			}
		}
	}
	if ((inp == 4))
	{
		if ((self.building.tf_items & 2))
		{
			sprint (self, 2, "It is already a turret!\n");
		}
		else
		{
			if ((self.building.currentammo > (6 - 2)))
			{
				sprint (self, 2, "This requires two upgrades, sorry.\n");
			}
			else
			{
				if ((self.ammo_cells >= (2 * 100)))
				{
					self.ammo_cells = (self.ammo_cells - (2 * 100));
					if ((self.ammo_cells < 0))
					{
						self.ammo_cells = 0;
					}
					self.building.currentammo = (self.building.currentammo + 2);
					if ((self.building.tf_items & 2))
					{
						sprint (self, 2, "Gun is already deployed./n");
					}
					else
					{
						self.building.origin_z = (self.building.origin_z + 15);
						/*if (0)	// useless statements-r-us?
						{
							sprint (self, 2, "You need a clear area to launch\n");
							self.building.origin_z = (self.building.origin_z - 15);
						}
						else*/
						{
							self.building.origin_z = (self.building.origin_z + 25);
							sprint (self, 2, "You turretize your tesla.\n");
							self.has_turretized_tesla = 1;
							self.building.angles_z = 180;
							self.building.flags = (self.building.flags - (self.building.flags & 512));
							self.building.movetype = 5;
							self.building.velocity_z = 200;
							setsize (self.building, '-16.000000 -16.000000 -40.000000', '16.000000 16.000000 -10.000000');
							self.building.tf_items = (self.building.tf_items | 2);
						}
					}
				}
				else
				{
					sprint (self, 2, "You need more cells to upgrade the tesla.\n");
				}
			}
		}
	}
	if ((inp == 5))
	{
		if ((self.building.tf_items & 1))
		{
			sprint (self, 2, "It already has an improved targeter.\n");
		}
		else
		{
			if ((self.building.currentammo > (6 - 2)))
			{
				sprint (self, 2, "This requires two upgrades, hence the '2u'...\n");
			}
			else
			{
				if ((self.ammo_cells >= (2 * 100)))
				{
					self.ammo_cells = (self.ammo_cells - (2 * 100));
					if ((self.ammo_cells < 0))
					{
						self.ammo_cells = 0;
					}
					self.building.currentammo = (self.building.currentammo + 2);
					self.building.tf_items = (self.building.tf_items | 1);
				}
				else
				{
					sprint (self, 2, "You need more cells to upgrade the tesla.\n");
				}
			}
		}
	}
	if ((inp == 6))
	{
		if ((self.building.tf_items & 1024))
		{
			sprint (self, 2, "You already built a spy detector.\n");
		}
		else
		{
			if ((self.building.currentammo > (6 - 4)))
			{
				sprint (self, 2, "Spy detector takes 4 upgrades.\n");
			}
			else
			{
				if ((self.ammo_cells >= (2 * 100)))
				{
					self.ammo_cells = (self.ammo_cells - (4 * 100));
					if ((self.ammo_cells < 0))
					{
						self.ammo_cells = 0;
					}
					self.building.currentammo = (self.building.currentammo + 4);
					self.building.tf_items = (self.building.tf_items | 1024);
				}
				else
				{
					sprint (self, 2, "You need more cells to upgrade the tesla.\n");
				}
			}
		}
	}
	if ((inp == 7))
	{
		if ((self.building.health < self.building.max_health))
		{
			cost = (self.building.max_health - self.building.health) / 2;
			if (cost > self.ammo_cells)
				cost = self.ammo_cells;
				self.ammo_cells = self.ammo_cells - cost;
			self.building.health = self.building.health + (cost * 2);
			if (self.building.health >= self.building.max_health)
				self.building.health = self.building.max_health;
		}
		if ((self.building.ammo_rockets == 0))
		{
			maxcells = 120;
		}
		else
		{
			if ((self.building.ammo_rockets == 1))
			{
				maxcells = 120;
			}
			else
			{
				if ((self.building.ammo_rockets == 2))
				{
					maxcells = 200;
				}
				else
				{
					if ((self.building.ammo_rockets == 3))
					{
						maxcells = 300;
					}
				}
			}
		}
		maxcells = maxcells + self.building.cells_bonus;
		cost = maxcells - self.building.ammo_cells;
		if ((cost > self.ammo_cells))
		{
			cost = self.ammo_cells;
		}
		self.ammo_cells = (self.ammo_cells - cost);
		self.building.ammo_cells = (self.building.ammo_cells + cost);
	}
	if ((inp == 8))
	{
		sprint (self, 2, "You dismantle the Tesla Gun.\n");
		self.ammo_cells = (self.ammo_cells + (150 / 2));
		self.building.real_owner.has_tesla = 0;
		self.building.real_owner.has_turretized_tesla = 0;
		if ((self.building.real_owner.team_no != self.team_no))
		{
			logfrag (self, self.building.real_owner);
			self.real_frags = (self.real_frags + 1);
			if (!(toggleflags & 128))
			{
				self.frags = self.real_frags;
			}
		}
		if ((self.building.real_owner != self))
		{
			sprint2 (self.building.real_owner, 2, self.netname, " dismantled your Tesla Coil.\n");
			teamsprint (self.building.real_owner.team_no, self.building.real_owner, self.netname);
			teamsprint (self.building.real_owner.team_no, self.building.real_owner, " dismantled ");
			teamsprint (self.building.real_owner.team_no, self.building.real_owner, self.building.real_owner.netname);
			teamsprint (self.building.real_owner.team_no, self.building.real_owner, "'s Tesla Coil.\n");
		}
		dremove (self.building);
	}
	if (inp == 9)	// Tinker
	{
		DoTinker();
	}
	if (((inp >= 1) && (inp <= 10)))
	{
		ResetMenu ();
		self.impulse = 0;
		bound_other_ammo (self);
		if ((self.armorvalue == 0))
		{
			self.armortype = 0;
			self.armorclass = 0;
			self.items = (self.items - (self.items & ((8192 | 16384) | 32768)));
		}
		W_SetCurrentAmmo ();
	}
};
void() Menu_Dispenser = 
{
	CenterPrint(self, "Use Dispenser:                     \n“‘.. Withdraw some ammo     \n”‘.. Withdraw some Armor    \n•‘.. Health & Vaccine       \n–‘.. BioSuit (AntiToaster)  \n—‘.. Nothing                \n\n");
};
void (float _p_1052) Menu_Dispenser_Input =
{
	local float _l_1053;
	local float _l_1054;
	local entity _l_1055;
	_l_1054 = 0.000000;
	if ((_p_1052 == 1.000000))
	{
		if (((((self.building.ammo_shells == 0.000000) && (self.building.ammo_nails == 0.000000)) && (self.building.ammo_rockets == 0.000000)) && (self.building.ammo_cells == 0.000000)))
		{
			_l_1054 = 1.000000;
		}
		else
		{
			_l_1053 = self.maxammo_shells - self.ammo_shells;
			if ((_l_1053 > self.building.ammo_shells))
			{
				_l_1053 = self.building.ammo_shells;
			}
			self.building.ammo_shells = (self.building.ammo_shells - _l_1053);
			self.ammo_shells = (self.ammo_shells + _l_1053);
			_l_1053 = self.maxammo_nails - self.ammo_nails;
			if ((_l_1053 > self.building.ammo_nails))
			{
				_l_1053 = self.building.ammo_nails;
			}
			self.building.ammo_nails = (self.building.ammo_nails - _l_1053);
			self.ammo_nails = (self.ammo_nails + _l_1053);
			_l_1053 = self.maxammo_rockets - self.ammo_rockets;
			if ((_l_1053 > self.building.ammo_rockets))
			{
				_l_1053 = self.building.ammo_rockets;
			}
			self.building.ammo_rockets = (self.building.ammo_rockets - _l_1053);
			self.ammo_rockets = (self.ammo_rockets + _l_1053);
			_l_1053 = self.maxammo_cells - self.ammo_cells;
			if ((_l_1053 > self.building.ammo_cells))
			{
				_l_1053 = self.building.ammo_cells;
			}
			self.building.ammo_cells = (self.building.ammo_cells - _l_1053);
			self.ammo_cells = (self.ammo_cells + _l_1053);
			sound (self, 3.000000, "weapons/rocklr1a.wav", 1.000000, 1.000000);
			if (self.autodiscard)
			{
				TeamFortress_Discard ();
			}
		}
	}
	else
	{
		if ((_p_1052 == 2.000000))
		{
			if ((self.building.armorvalue == 0.000000))
			{
				_l_1054 = 1.000000;
			}
			else
			{
				_l_1053 = self.maxarmor - self.armorvalue;
				if ((_l_1053 > self.building.armorvalue))
				{
					_l_1053 = self.building.armorvalue;
				}
				if ((self.armortype == 0.000000))
				{
					self.armortype = 0.300000;
					self.items = (self.items | 8192.000000);
				}
				self.building.armorvalue = (self.building.armorvalue - _l_1053);
				self.armorvalue = (self.armorvalue + _l_1053);
				sound (self, 3.000000, "weapons/tnkatck4.wav", 1.000000, 1.000000);
			}
		}
		else
		{
			if ((_p_1052 == 3.000000))
			{
				if ((self.building.armorvalue == 0.000000))
				{
					_l_1054 = 1.000000;
				}
				else
				{
					if ((self.building.skin == 1.000000))
					{
						if ((self.leg_damage > 1.000000))
						{
							sprint (self, 2.000000, "Your leg wound has been healed!\n");
						}
						TeamFortress_SetSpeed (self);
						_l_1055 = find (world, classname, "timer");
						while ((((_l_1055.owner != self) || (_l_1055.think != ConcussionGrenadeTimer)) && (_l_1055 != world)))
						{
							_l_1055 = find (_l_1055, classname, "timer");
						}
						if ((_l_1055 != world))
						{
							stuffcmd (self, "v_idlescale 0\n");
							sprint (self, 2.000000, "you have been healed of your concussion.\n");
							dremove (_l_1055);
						}
						if ((self.tfstate & 16384.000000))
						{
							_l_1055 = find (world, classname, "timer");
							while ((((_l_1055.owner != self) || (_l_1055.think != HallucinationTimer)) && (_l_1055 != world)))
							{
								_l_1055 = find (_l_1055, classname, "timer");
							}
							if ((_l_1055 != world))
							{
								stuffcmd (self, "v_idlescale 0\n");
								self.tfstate = (self.tfstate - (self.tfstate & 16384.000000));
								sprint (self, 2.000000, "you have been healed of your hallucinations.\n");
								dremove (_l_1055);
							}
							else
							{
								dprint ("Warning: Error in Hallucination Timer logic.\n");
							}
						}
						if ((self.tfstate & 32768.000000))
						{
							_l_1055 = find (world, classname, "timer");
							while ((((_l_1055.owner != self) || (_l_1055.think != TranquiliserTimer)) && (_l_1055 != world)))
							{
								_l_1055 = find (_l_1055, classname, "timer");
							}
							if ((_l_1055 != world))
							{
								self.tfstate = (self.tfstate - (self.tfstate & 32768.000000));
								TeamFortress_SetSpeed (self);
								stuffcmd (self, "v_cshift 0 0 0 0\n");
								sprint (self, 2.000000, "you have been healed of your tranquilisation.\n");
								dremove (_l_1055);
							}
							else
							{
								dprint ("Warning: Error in Tranquilisation Timer logic.\n");
							}
						}
						if ((self.FlashTime > 0.000000))
						{
							_l_1055 = find (world, netname, "flashtimer");
							while ((((_l_1055.owner != self) || (_l_1055.classname != "timer")) && (_l_1055 != world)))
							{
								_l_1055 = find (_l_1055, netname, "flashtimer");
							}
							if ((_l_1055 != world))
							{
								self.FlashTime = 0.000000;
								stuffcmd (self, "v_cshift 0 0 0 0\n");
								dremove (_l_1055);
							}
							else
							{
								dprint ("Warning: Error in Flash Timer logic.\n");
								self.FlashTime = 0.000000;
							}
						}
						if ((self.tfstate & 16.000000))
						{
							self.tfstate = (self.tfstate - (self.tfstate & 16.000000));
							deathmsg = 23.000000;
							sprint (self, 2.000000, "Your infection is cured!\n");
							return;
						}
						if ((self.numflames > 0.000000))
						{
							sound (self, 1.000000, "items/r_item1.wav", 1.000000, 1.000000);
							self.numflames = 0.000000;
							sprint (self, 2.000000, "The flames have been doused!\n");
							return;
						}
						self.health = (self.health + 25.000000);
						self.tfstate = (self.tfstate - (self.tfstate & 16.000000));
					}
					else
					{
						sprint (self, 2.000000, "No vaccine has been loaded by Medic.\n");
					}
					if ((self.health >= self.max_health))
					{
						self.health = self.max_health;
					}
					sound (self, 3.000000, "items/health1.wav", 1.000000, 1.000000);
				}
			}
			else
			{
				if ((_p_1052 == 4.000000))
				{
					if ((self.building.skin == 1.000000))
					{
						self.items = (self.items | 2097152.000000);
						self.rad_time = 1.000000;
						self.radsuit_finished = (time + 30.000000);
						sprint (self, 2.000000, "You have a BioSuit.\n");
					}
					else
					{
						sprint (self, 2.000000, "No BioSuit has been loaded by Medic.\n");
					}
				}
			}
		}
	}
	if (((_p_1052 >= 1.000000) && (_p_1052 <= 5.000000)))
	{
		if (_l_1054)
		{
			sprint (self, 2.000000, "The dispenser is empty.\n");
		}
		ResetMenu ();
		self.impulse = 0.000000;
		self.building = world;
		self.building_wait = (time + 0.500000);
		bound_other_ammo (self);
		if ((self.armorvalue == 0.000000))
		{
			self.armortype = 0.000000;
			self.armorclass = 0.000000;
			self.items = (self.items - (self.items & 57344.000000));
		}
		W_SetCurrentAmmo ();
	}
};
void() Menu_EngineerFix_Teleporter =
{
	if (self.building.classname == "building_teleporter" && (self.building.tf_items & 2))
	{
		CenterPrint(self, "Áãôéïî:                \n\n.. Repair Teleporter .    \n.. Recharge Teleporter .  \n\n.. Îïôèéîç .             \n\n.. Dismantle .            \n");
	}
	else
	{
		CenterPrint(self, "Áãôéïî:                \n\n.. Repair Teleporter.     \n.. Recharge Teleporter   \n\n.. Îïôèéîç               \n\n.. Dismantle.             \n");
	}
};
void(float inp) Menu_EngineerFix_Teleporter_Input =
{
	local float metalcost; //am,
	if (self.classname != "player" || self.building == world)
		return;
	if (inp == 1)
	{
		metalcost = (self.building.max_health - self.building.health) / 5;

		if (metalcost > self.ammo_cells)
			metalcost = ceil(self.ammo_cells);

		self.ammo_cells = self.ammo_cells - metalcost;
		self.building.health = self.building.health + (metalcost * 5);
	}
	else
	if (inp == 2)
	{
		metalcost = (self.building.maxammo_cells - self.building.ammo_cells);
		if (metalcost > self.ammo_cells)
			metalcost = ceil(self.ammo_cells);
		self.ammo_cells = self.ammo_cells - metalcost;
		self.building.ammo_cells = self.building.ammo_cells + metalcost;
		if (self.building.ammo_cells > self.building.maxammo_cells)
			self.building.ammo_cells = self.building.maxammo_cells;
	}
	else
	if (inp == 8)
	{
		sprint(self, #PRINT_HIGH, "You dismantle the Teleporter Pad.\n");
		self.ammo_cells = self.ammo_cells + (90 * 0.5) + floor(self.building.health / 15);
		self.building.real_owner.has_teleporter = (self.building.real_owner.has_teleporter - 1);
		self.building.health=0; // - OfN aborts hacks on it
		dremove(self.building);
	}
	else
	if (inp == 10)
	{
		ResetMenu();
		self.impulse = 0;
		return;
	}
		if ((inp >= 1 && inp <= 3) || inp == 8)
	{
		ResetMenu();
		self.impulse = 0;
		bound_other_ammo(self);
		if (self.armorvalue == 0)
		{
			self.armortype = 0;	// lost all armor
			self.armorclass = 0; // lost special armor
			self.items = self.items - (self.items & (8192 | 16384 | 32768));
		}
		W_SetCurrentAmmo();
	}
};
void() Menu_EngineerFix_Camera =
{
	CenterPrint(self, "Áãôéïî:                \n\n.. Repair Camera      \n\n.. Îïôèéîç            \n\n.. Dismantle          \n");
};
void(float inp) Menu_EngineerFix_Camera_Input =
{
	local float metalcost; //am,
	if (self.classname != "player" || self.building == world)
		return;
	if (inp == 1)
	{
		metalcost = (self.building.max_health - self.building.health) / 10;
		if (metalcost > self.ammo_cells)
			metalcost = self.ammo_cells;
		self.ammo_cells = self.ammo_cells - metalcost;
		self.building.health = self.building.health + (metalcost * 10);
	}
	else
	if (inp == 3)
	{
		sprint(self, #PRINT_HIGH, "You dismantle the Security Camera.\n");
		self.ammo_cells = self.ammo_cells + (#BUILD_COST_CAMERA * 0.5) + floor(self.building.health / 40);
		self.building.real_owner.has_camera = 0;
		self.building.health=0; // - OfN aborts hacks on it
		dremove(self.building);
	}
	if (inp >= 1 && inp <= 3)
	{
		ResetMenu();
		self.impulse = 0;
		bound_other_ammo(self);
		if (self.armorvalue == 0)
		{
			self.armortype = 0;	// lost all armor
			self.armorclass = 0; // lost special armor
			self.items = self.items - (self.items & (#IT_ARMOR1 | #IT_ARMOR2 | #IT_ARMOR3));
		}

		W_SetCurrentAmmo();
	}
};
void() Menu_NewTaunts = 
{
#ifdef mtf_coop_halloween
	CenterPrint(self, "€ Costume Menu ‚\n\n€“‚ Duke Nukem           \n€”‚ Boba Fett            \n€•‚ Spider-Man           \n  €–‚ Captain Picard         \n€—‚ Skeletor             \n€˜‚ Commander Worf       \n€™‚ Doom Guy             \n€š‚ Chewbacca            \n€›‚ Nothing              \n");
#else
	CenterPrint(self, "€ Taunt Menu 2 ‚\n\n€“‚ How many assholes    \n€”‚ Keep firing, assholes\n€•‚ Surrounded by a-holes\n  €–‚ You bearded bitch!     \n€—‚                      \n€˜‚ NI!                  \n€™‚ I do believe..       \n€š‚                      \n€›‚ Nothing              \n");
#endif
};
void(float inp) Menu_NewTaunts_Input = 
{
#ifdef mtf_coop_halloween
	if (inp == 1)
	{
		stuffcmd(self, "skin duke\n");
	}
	else
	{
		if (inp == 2)
		{
			stuffcmd(self, "skin boba\n");
		}
		else
		{
			if (inp == 3)
			{
				stuffcmd(self, "skin spidey\n");
			}
			else
			{
				if (inp == 4)
				{
					stuffcmd(self, "skin picard\n");
				}
				else
				{
					if (inp == 5)
					{
						stuffcmd(self, "skin skel\n");
					}
					else
					{
						if (inp == 6)
						{
							stuffcmd(self, "skin batleth\n");
						}
						else
						{
							if (inp == 7)
							{
								stuffcmd(self, "skin doomguy\n");
							}
							else
							{
								if (inp == 8)
								{
									stuffcmd(self, "skin chewie\n");
								}
								else
								{
									if (inp > 8)
									{
										ResetMenu();
									}
								}
							}
						}
					}
				}
			}
		}
	}
#else
	if (inp == 1)
	{
	bprint (1, self.netname);
	bprint (1.000000, " mumbles about the other player's family heritage!\n");
	}
	else
	{
		if (inp == 2)
		{
		bprint (1, self.netname);
				bprint (1.000000, " Keep firing asshole!!\n");
		}
		else
		{
			if (inp == 3)
			{
			}
			else
			{
				if (inp == 4)
				{
				bprint (1, self.netname);
				bprint (1.000000, " calls him a bearded lady!\n");
				}
				else
				{
					if (inp == 5)
					{
					bprint (1, self.netname);
					bprint (1.000000, ", and I will taunt you a second time!\n");
					}
					else
					{
						if (inp == 6)
						{
							if ( !(self.last_saveme_sound > time) )
							{
								self.last_saveme_sound = (time + 5);
								bprint (1, self.netname);
								bprint (1.000000, " says Ni! Ni! Ni!\n");
							}
						}
						else
						{
							if (inp == 7)
							{
							bprint (1, self.netname);
								bprint (1.000000, " says well that sucked ass!\n");
								//sound(self, TF_FLARE_OFF, "taunts/sucked_a.wav", TF_FLARE_OFF, TF_FLARE_OFF);
							}
							else
							{
								if (inp == 8)
								{
								bprint (1, self.netname);
								bprint (1.000000, " says Respect my Authoritahy!\n");
									//sound(self, TF_FLARE_OFF, "taunts/authority.wav", TF_FLARE_OFF, TF_FLARE_OFF);
								}
								else
								{
									if (inp > 8)
									{
										ResetMenu();
									}
								}
							}
						}
					}
				}
			}
		}
	}
#endif
	ResetMenu();
	self.impulse = TF_FLARE_LIT;
};
void () MTF_Resurrect_Player_Find;
void () Menu_Res =
{
	centerprint(self, "Nearby player is requesting a resurrect\n\nResurrect?\n1‘ Yes\n2‘ No \n");
};
void (float inp) Menu_Res_Input =
{
	if (inp == 1)
		MTF_Resurrect_Player_Find();

	self.impulse = 0.000000;
	self.current_menu = 0.000000;
	CenterPrint (self, "\n");
};
void () Menu_VoteChoice =
{
	local string nm_name;
	if (votestarted == #VOTE_EXIT)
		centerprint(self, "A player has called a vote to\nÅØÉÔ the map\n\n1‘ Agree   \n2‘ Disagree\n");
	if (votestarted == #VOTE_USE)
		centerprint(self, "A player has called a vote to\nÕÓÅ an entity\n\n1‘ Agree   \n2‘ Disagree\n");
	if (votestarted == #VOTE_NEXTMAP)
	{
		nm_name = infokey (world, "nextmap");
		CenterPrint4(self, "A player has called a vote for the\nÎÅØÔ ÍÁÐ to be [see console] \n\n1‘ Agree   \n2‘ Disagree\n");
	}
	if (votestarted == #VOTE_SURVIVAL_NEXT)
		centerprint(self, "A player has called a vote to\nchange the \sGAME MODE\s to \sSURVIVAL\s\nfor the next map.\n\n1‘ Agree   \n2‘ Disagree\n");
};
void (float inp) Menu_VoteChoice_Input =
{
	if (inp == 1)
		voteyes();
	self.impulse = 0.000000;
	self.current_menu = 0.000000;
	CenterPrint (self, "\n");
};
void () Menu_Merchant =
{
	local string itemlist;
	if (merchant.#item1)
	{
		itemlist = strcat( "1) ", Inventory_GetItemName( merchant.#item1 ), " - Cost: " );
		itemlist = strcat(itemlist, ftos(Inventory_GetItemPrice( merchant.#item1 )), "\n");
	}
	if (merchant.#item2)
	{
		itemlist = strcat( itemlist, "2) ", Inventory_GetItemName( merchant.#item2 ), " - Cost: " );
		itemlist = strcat(itemlist, ftos(Inventory_GetItemPrice( merchant.#item2 )), "\n");
	}
	if (merchant.#item3)
	{
		itemlist = strcat( itemlist, "3) ", Inventory_GetItemName( merchant.#item3 ), " - Cost: " );
		itemlist = strcat(itemlist, ftos(Inventory_GetItemPrice( merchant.#item3 )), "\n");
	}
	if (merchant.#item4)
	{
		itemlist = strcat( itemlist, "4) ", Inventory_GetItemName( merchant.#item4 ), " - Cost: " );
		itemlist = strcat(itemlist, ftos(Inventory_GetItemPrice( merchant.#item4 )), "\n");
	}
	if (merchant.#item5)
	{
		itemlist = strcat( itemlist, "5) ", Inventory_GetItemName( merchant.#item5 ), " - Cost: " );
		itemlist = strcat(itemlist, ftos(Inventory_GetItemPrice( merchant.#item5 )), "\n");
	}
	if (self.connect_name == "Äoc")		// teehee
		itemlist = strcat( itemlist, "\n\n6) ÓÅÌÌ ÉÔÅÍÓ\n\n\n7) Ðìáù Âìáãëêáãë\n8) Ãèáîçå Äïã§ó Äéáðåòó" );
	else
		itemlist = strcat( itemlist, "\n\n6) ÓÅÌÌ ÉÔÅÍÓ\n\n\n7) Ðìáù Âìáãëêáãë\n8) Ãèáîçå Ùïõò Ãìáóó" );
	itemlist = strzone(itemlist);


	if (merchant.#merchant_type == 3)
		CenterPrint6( self, "Runes, powerups, and rare items for sale!\n", itemlist );
	else
	if(merchant.#merchant_type == 2)
		CenterPrint6( self, "Weapon upgrades and ammo boosts for sale\n", itemlist );
	else
		CenterPrint6( self, "Got a lot of good items up for sale!\n", itemlist );
	strunzone(itemlist);
	self.current_menu = 0;
};
#define playerhand		has_mini
#define dealerhand		has_voted
#define resultmenu		has_teleporter
void () Blackjack_Think =
{
	local float goldamount;
	local string dealerstring;
	if (self.owner == world)
		dremove(self);
	if (self.owner.current_menu != 44)
		dremove(self);
	if (merchant.#gold <= 0 && self.#gold == 0)
	{
		sprint( self.owner, 2, "Merchant is no longer currently dealing blackjack. Try again later.\n");
		self.owner.impulse = 0;
		self.owner.current_menu = 0;
		CenterPrint (self.owner, "\n");
		dremove(self);
	}
	if (self.#gold > 0)
	{		// Game has started
		if (self.#dealerhand == 0)
			self.#dealerhand = 15 + rint(random() * 6);
		dealerstring = strcat("Your current bet: ", ftos(self.#gold), "\n");
		dealerstring = strcat(dealerstring, "Your current hand:", ftos(self.#playerhand), "\n\n1) Hit \n2) Stay\n");
		dealerstring = strzone(dealerstring);
		CenterPrint6 (self.owner, "‰‰ Âìáãëêáãë ‰‰\n", dealerstring);
		strunzone(dealerstring);
		if (self.has_tesla == 1)
			self.#playerhand += 1 + rint(random() * 9);
		else
		if (self.has_tesla == 2)
		{
			if (self.#playerhand >= self.#dealerhand)
			{
				self.#resultmenu = 1;
				Inventory_AddGold( self.owner, self.#gold * 2);
				sprint( self.owner, 2, "You win " );
				sprint( self.owner, 2, ftos(self.#gold) );
				sprint( self.owner, 2, " gold!\n" );
				if (self.#gold >= 1000)
				{
					Achievements_Change( self.owner, world, ACHIEVEMENTS_ADD, ACHIEVEMENT_GAMBLER, 1 );
				}
				self.#gold = 0;
		}
			else
			{
				self.#resultmenu = 2;
				sprint( self.owner, 2, "Dealer's hand was " );
				sprint( self.owner, 2, ftos(self.#dealerhand) );
				sprint( self.owner, 2, ". Tough luck.\n" );
				self.#gold = 0;
			}
			self.#dealerhand = 0;
			self.#playerhand = 0;
		}
		if (self.#playerhand > 21)
		{
			self.#resultmenu = 2;
			sprint( self.owner, 2, "Player's hand exceeds 21. Better luck next time, pal.\n" );
			self.#gold = 0;
			self.#dealerhand = 0;
			self.#playerhand = 0;
		}
		self.has_tesla = 0;
	}
	else
	{	// Game hasn't started yet
		if (self.#resultmenu == 0)
			CenterPrint (self.owner, "Choose how much you want to bet:\n\n1) 100 \n2) 500 \n3) 1000\n4) Exit" );
		else
		if (self.#resultmenu == 1)
			CenterPrint (self.owner, "You won!\nWant to try again?\n\n1) 100 \n2) 500 \n3) 1000\n4) Nah " );
		else
		if (self.#resultmenu == 2)
			CenterPrint (self.owner, "You lost :(\nTry again?\n\n1) 100 \n2) 500 \n3) 1000\n4) Nah " );
		if (self.has_tesla == 1)
			goldamount = 100;
		else
		if (self.has_tesla == 2)
			goldamount = 500;
		else
		if (self.has_tesla == 3)
			goldamount = 1000;
		else
		if (self.has_tesla == 4)
			goldamount = -1;
		if (goldamount > self.owner.#gold)
		{
			sprint( self.owner, 2, "You do not have enough gold to make that bet.\n" );
		}
		else
		if (goldamount > 0)
		{
			self.#gold = goldamount;
			merchant.#gold -= goldamount;
			Inventory_AddGold (self.owner, -1 * goldamount );
		}
		else
		if (goldamount == -1)
		{
			self.owner.impulse = 0;
			self.owner.current_menu = 0.000000;
			CenterPrint (self.owner, "\n");
			dremove(self);
		}
		self.has_tesla = 0;
	}
	self.nextthink = time + .1;
};
void ( float inp ) Menu_Merchant_Input =
{
	local entity minigame;
	if (inp == 1)
	{
		if (Inventory_AddItem( self, merchant.#item1, Inventory_GetItemPrice( merchant.#item1 ) ))
			merchant.#item1 = 0;
	}
	else
	if (inp == 2)
	{
		if (Inventory_AddItem( self, merchant.#item2, Inventory_GetItemPrice( merchant.#item2 ) ))
			merchant.#item2 = 0;
	}
	else
	if (inp == 3)
	{
		if (Inventory_AddItem( self, merchant.#item3, Inventory_GetItemPrice( merchant.#item3 ) ))
			merchant.#item3 = 0;
	}
	else
	if (inp == 4)
	{
		if (Inventory_AddItem( self, merchant.#item4, Inventory_GetItemPrice( merchant.#item4 ) ))
			merchant.#item4 = 0;
	}
	else
	if (inp == 5)
	{
		if (Inventory_AddItem( self, merchant.#item5, Inventory_GetItemPrice( merchant.#item5 ) ))
			merchant.#item5 = 0;
	}
	else
	if (inp == 6)
	{
		sprint( self, 2, "Inventory items this merchant will buy off you:\n" );
		Inventory_PrintItems( self.connect_name, #P_TO_SELF_W_VALUE );
		sprint( self, 2, "To sell one of these items, use \"cmd inv sell #\" .\n" );
	}
	else
	if (inp == 7)
	{
		self.impulse = 0;
		self.current_menu = 44;
		CenterPrint (self, "\n");
		minigame = spawn();
		minigame.owner = self;
		minigame.think = Blackjack_Think;
		minigame.nextthink = time;
		minigame.classname = "minigame";
		return;
	}
#ifdef mtf_coop_quests
	else
	if (inp == 8)
	{
		self.impulse = 0;
		self.current_menu = 45;
		CenterPrint (self, "\n");
		minigame = spawn();
		minigame.owner = self;
		minigame.think = Quest_Think;
		minigame.nextthink = time;
		minigame.#questid = merchant.#questid;
		minigame.classname = "questmenu";
		return;	
	}
#endif
	else
	if (inp == 8)
	{				// Change class menu
		CenterPrint (self, "\n");
		self.current_menu = 3;
		self.menu_displaytime = 25;
		self.menu_count = 25;
		self.oldcurrentammo = 1;
		self.impulse = 0.000000;
		return;
	}
	self.impulse = 0.000000;
	self.current_menu = 0.000000;
	CenterPrint (self, "\n");
};
void () Menu_Blackjack =
{};
void ( float inp ) Menu_Blackjack_Input =
{
	local entity te;
	if (inp > 0 || inp < 5)
	{
		te = find(world, classname, "minigame");
		while (te)
		{
			if (te.owner == self)
			{
				te.has_tesla = inp;
				self.impulse = 0;
				CenterPrint (self, "\n");
				return;
			}
			te = find(te, classname, "minigame");
		}
		return;
	}
	self.impulse = 0.000000;
	self.current_menu = 0.000000;
	CenterPrint (self, "\n");
};
#ifdef mtf_coop_quests
void () Menu_Quest =
{};
void ( float inp ) Menu_Quest_Input =
{
	local entity te;
	if (inp > 0 || inp < 5)
	{
		te = find(world, classname, "questmenu");
		while (te)
		{
			if (te.owner == self)
			{
				te.has_tesla = inp;
				self.impulse = 0;
				CenterPrint (self, "\n");
				return;
			}
			te = find(te, classname, "questmenu");
		}
		return;
	}
	self.impulse = 0.000000;
	self.current_menu = 0.000000;
	CenterPrint (self, "\n");
};
#define quest_menu		has_mini
void () Quest_Think =
{
	if (self.owner == world)
		dremove(self);
	if (self.owner.current_menu != 45)
		dremove(self);
	if (self.#questid == 0)
	{
		self.owner.impulse = 0;
		self.owner.current_menu = 0;
		CenterPrint (self.owner, "\n");
		dremove(self);
	}
	if (merchant.#questid == 0)
	{
		sprint( self.owner, 2, "This merchant has no quests available.\n");
		self.owner.impulse = 0;
		self.owner.current_menu = 0;
		CenterPrint (self.owner, "\n");
		dremove(self);
	}
	if (self.#quest_menu == 0)
		CenterPrint6 (self.owner, "[Quests]\n\nAvailable Quest:\n", "[1] ", Quest_GetValueFor( #QUESTINFO_DESCRIPTION, merchant.#questid, self.owner ), "\n[4] Return\n" );
	else
		CenterPrint6 (self.owner, "[", Quest_GetValueFor( #QUESTINFO_DESCRIPTION, merchant.#questid, self.owner ), "]\n\n", Quest_GetValueFor( #QUESTINFO_DIALOGUE, merchant.#questid, self.owner ), "\n\n[1] Accept \n[2] Decline \n");
	if (self.#quest_menu == 0)
	{
		if (self.has_tesla == 1)
		{
			self.#quest_menu = 1;
		}
		else
		if (self.has_tesla == 2)
			self.#questid = 0;
		self.has_tesla = 0;
	}
	else
	{
		if (self.has_tesla == 1)
		{
			if (self.owner.#questid == merchant.#questid)
			{
				sprint( self.owner, 2, "You have not completed this quest yet. If you wish to cancel a quest, use \"cmd quest cancel\" in the console.\n" );
			}
			else
			if (self.owner.#questid)
			{
				sprint( self.owner, 2, "You are currently engaged in a quest. If you wish to cancel a quest, use \"cmd quest cancel\" in the console.\n" );
			}
			else
			{
				Quest_SetFor( self.owner, self.#questid );
				self.#questid = 0;
			}
			self.has_tesla = 0;
		}
		else
		if (self.has_tesla == 2)
			self.#questid = 0;
	}
	self.nextthink = time + .1;
};
#endif
//END
